<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Data Structures | Data Structures and Dynamic Optimization with Matlab</title>
  <meta name="description" content="Group table by one or several group variables, and aggregate over another numerical variable within group." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Data Structures | Data Structures and Dynamic Optimization with Matlab" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Group table by one or several group variables, and aggregate over another numerical variable within group." />
  <meta name="github-repo" content="fanwangecon/M4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Data Structures | Data Structures and Dynamic Optimization with Matlab" />
  
  <meta name="twitter:description" content="Group table by one or several group variables, and aggregate over another numerical variable within group." />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="functions-and-programming.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-6');
</script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Dynamic Optimization with Matlab</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>1</b> Data Structures</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-structures.html"><a href="data-structures.html#matrices-and-arrays"><i class="fa fa-check"></i><b>1.1</b> Matrices and Arrays</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data-structures.html"><a href="data-structures.html#array-reshape-repeat-and-expand-examples"><i class="fa fa-check"></i><b>1.1.1</b> Array Reshape, Repeat and Expand Examples</a></li>
<li class="chapter" data-level="1.1.2" data-path="data-structures.html"><a href="data-structures.html#array-index-slicing-and-subsetting-to-replace-and-expand"><i class="fa fa-check"></i><b>1.1.2</b> Array Index Slicing and Subsetting to Replace and Expand</a></li>
<li class="chapter" data-level="1.1.3" data-path="data-structures.html"><a href="data-structures.html#maximum-of-matrix-columns-sort-matrix-columns"><i class="fa fa-check"></i><b>1.1.3</b> Maximum of Matrix Columns, Sort Matrix Columns</a></li>
<li class="chapter" data-level="1.1.4" data-path="data-structures.html"><a href="data-structures.html#array-broadcast-and-expansion-examples"><i class="fa fa-check"></i><b>1.1.4</b> Array Broadcast and Expansion Examples</a></li>
<li class="chapter" data-level="1.1.5" data-path="data-structures.html"><a href="data-structures.html#grid-states-choices-and-optimal-choices-example"><i class="fa fa-check"></i><b>1.1.5</b> Grid States, Choices and Optimal Choices Example</a></li>
<li class="chapter" data-level="1.1.6" data-path="data-structures.html"><a href="data-structures.html#accumarray-examples"><i class="fa fa-check"></i><b>1.1.6</b> Accumarray Examples</a></li>
<li class="chapter" data-level="1.1.7" data-path="data-structures.html"><a href="data-structures.html#matlab-miscellaneous-and-basic-numeric-and-array-operations"><i class="fa fa-check"></i><b>1.1.7</b> Matlab Miscellaneous and Basic Numeric and Array Operations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data-structures.html"><a href="data-structures.html#nd-dimensional-arrays"><i class="fa fa-check"></i><b>1.2</b> ND Dimensional Arrays</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-structures.html"><a href="data-structures.html#joint-arrays-all-combinations-and-by-random-subset"><i class="fa fa-check"></i><b>1.2.1</b> Joint Arrays All Combinations and by Random Subset</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-structures.html"><a href="data-structures.html#d-4d-nd-arrays-reshape-and-rearrange-dimensions"><i class="fa fa-check"></i><b>1.2.2</b> 3D, 4D, ND Arrays Reshape and Rearrange Dimensions</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-structures.html"><a href="data-structures.html#multidimensional-nd-array-to-2d-matrix-with-wide-to-long"><i class="fa fa-check"></i><b>1.2.3</b> Multidimensional ND Array to 2D Matrix with Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-structures.html"><a href="data-structures.html#cells"><i class="fa fa-check"></i><b>1.3</b> Cells</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-structures.html"><a href="data-structures.html#matlab-cell-array-basic-operations"><i class="fa fa-check"></i><b>1.3.1</b> Matlab Cell Array Basic Operations</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-structures.html"><a href="data-structures.html#matlab-list-comprehension-with-cells"><i class="fa fa-check"></i><b>1.3.2</b> Matlab List Comprehension with Cells</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-structures.html"><a href="data-structures.html#all-possible-combinations-of-multiple-arrays"><i class="fa fa-check"></i><b>1.3.3</b> All Possible Combinations of Multiple Arrays</a></li>
<li class="chapter" data-level="1.3.4" data-path="data-structures.html"><a href="data-structures.html#nested-cells"><i class="fa fa-check"></i><b>1.3.4</b> Nested Cells</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-structures.html"><a href="data-structures.html#characters-and-strings"><i class="fa fa-check"></i><b>1.4</b> Characters and Strings</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="data-structures.html"><a href="data-structures.html#basic-string-operations-display-search-join-and-split"><i class="fa fa-check"></i><b>1.4.1</b> Basic String Operations, Display, Search, Join and Split</a></li>
<li class="chapter" data-level="1.4.2" data-path="data-structures.html"><a href="data-structures.html#string-array-manipulations-join-find-replace-and-the-alphabet"><i class="fa fa-check"></i><b>1.4.2</b> String Array Manipulations, Join, Find, Replace and the Alphabet</a></li>
<li class="chapter" data-level="1.4.3" data-path="data-structures.html"><a href="data-structures.html#convert-and-concatenate-strings-arrays-with-numbers-and-number-arrays-with-strings"><i class="fa fa-check"></i><b>1.4.3</b> Convert and Concatenate Strings Arrays with Numbers and Number Arrays with Strings</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="data-structures.html"><a href="data-structures.html#map-containers"><i class="fa fa-check"></i><b>1.5</b> Map Containers</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="data-structures.html"><a href="data-structures.html#container-map-basics"><i class="fa fa-check"></i><b>1.5.1</b> Container Map Basics</a></li>
<li class="chapter" data-level="1.5.2" data-path="data-structures.html"><a href="data-structures.html#container-map-display-swtich-key-and-values-and-subseting"><i class="fa fa-check"></i><b>1.5.2</b> Container Map Display Swtich Key and Values and Subseting</a></li>
<li class="chapter" data-level="1.5.3" data-path="data-structures.html"><a href="data-structures.html#container-map-example-overriding"><i class="fa fa-check"></i><b>1.5.3</b> Container Map Example Overriding</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="data-structures.html"><a href="data-structures.html#map-structure-array"><i class="fa fa-check"></i><b>1.6</b> Map Structure Array</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="data-structures.html"><a href="data-structures.html#maplab-nested-container-map-with-struct"><i class="fa fa-check"></i><b>1.6.1</b> Maplab Nested Container Map with Struct</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="functions-and-programming.html"><a href="functions-and-programming.html"><i class="fa fa-check"></i><b>2</b> Functions and Programming</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#development-and-debugging"><i class="fa fa-check"></i><b>2.1</b> Development and Debugging</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#matlab-error-and-warning-handling"><i class="fa fa-check"></i><b>2.1.1</b> Matlab Error and Warning Handling</a></li>
<li class="chapter" data-level="2.1.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#matlab-profiler-save-to-html"><i class="fa fa-check"></i><b>2.1.2</b> Matlab Profiler Save to HTML</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#varargin-default-parameters"><i class="fa fa-check"></i><b>2.2</b> varargin Default Parameters</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#varargin-as-a-function-parameter"><i class="fa fa-check"></i><b>2.2.1</b> varargin as a Function Parameter</a></li>
<li class="chapter" data-level="2.2.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#container-default-parameter-with-varargin"><i class="fa fa-check"></i><b>2.2.2</b> Container Default Parameter with varargin</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="functions-and-programming.html"><a href="functions-and-programming.html#dynamic-functions"><i class="fa fa-check"></i><b>2.3</b> Dynamic Functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#anonymous-function-in-matlab"><i class="fa fa-check"></i><b>2.3.1</b> Anonymous Function in Matlab</a></li>
<li class="chapter" data-level="2.3.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#dynamically-generate-m-files"><i class="fa fa-check"></i><b>2.3.2</b> Dynamically Generate M Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="distributional-processes.html"><a href="distributional-processes.html"><i class="fa fa-check"></i><b>3</b> Distributional Processes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="distributional-processes.html"><a href="distributional-processes.html#time-series"><i class="fa fa-check"></i><b>3.1</b> Time Series</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="distributional-processes.html"><a href="distributional-processes.html#simulate-ar1-autoregressive-processes"><i class="fa fa-check"></i><b>3.1.1</b> Simulate AR(1) Autoregressive Processes</a></li>
<li class="chapter" data-level="3.1.2" data-path="distributional-processes.html"><a href="distributional-processes.html#matlab-moving-average-of-time-series"><i class="fa fa-check"></i><b>3.1.2</b> Matlab Moving Average of Time-series</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="distributional-processes.html"><a href="distributional-processes.html#cross-sectional-data"><i class="fa fa-check"></i><b>3.2</b> Cross-sectional Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="distributional-processes.html"><a href="distributional-processes.html#matlab-mincer-wage-earnings-equation-with-experience-education-and-gamma-shocks"><i class="fa fa-check"></i><b>3.2.1</b> Matlab Mincer Wage Earnings Equation with Experience, Education and Gamma Shocks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>4</b> Simulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulation.html"><a href="simulation.html#normal-distribution"><i class="fa fa-check"></i><b>4.1</b> Normal Distribution</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="simulation.html"><a href="simulation.html#compute-cdf-for-normal-and-bivariate-normal-distributions"><i class="fa fa-check"></i><b>4.1.1</b> Compute CDF for Normal and Bivariate Normal Distributions</a></li>
<li class="chapter" data-level="4.1.2" data-path="simulation.html"><a href="simulation.html#cholesky-decomposition-correlated-bivariate-normal-from-iid-random-draws"><i class="fa fa-check"></i><b>4.1.2</b> Cholesky Decomposition Correlated Bivariate Normal from IID Random Draws</a></li>
<li class="chapter" data-level="4.1.3" data-path="simulation.html"><a href="simulation.html#cholesky-decomposition-correlated-five-dimensional-multivariate-normal-shock"><i class="fa fa-check"></i><b>4.1.3</b> Cholesky Decomposition Correlated Five Dimensional Multivariate Normal Shock</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>5</b> Estimation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation.html"><a href="estimation.html#linear-estimation"><i class="fa fa-check"></i><b>5.1</b> Linear Estimation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estimation.html"><a href="estimation.html#linear-ols-regression"><i class="fa fa-check"></i><b>5.1.1</b> Linear OLS Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estimation.html"><a href="estimation.html#nonlinear-estimation"><i class="fa fa-check"></i><b>5.2</b> Nonlinear Estimation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="estimation.html"><a href="estimation.html#nonlinear-estimation-with-fminunc"><i class="fa fa-check"></i><b>5.2.1</b> Nonlinear Estimation with Fminunc</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>6</b> Graphs</a>
<ul>
<li class="chapter" data-level="6.1" data-path="graphs.html"><a href="graphs.html#figure-components"><i class="fa fa-check"></i><b>6.1</b> Figure Components</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="graphs.html"><a href="graphs.html#matlab-graph-safe-colors-for-web-presentation-and-publications-examples"><i class="fa fa-check"></i><b>6.1.1</b> Matlab Graph Safe Colors for Web, Presentation and Publications Examples</a></li>
<li class="chapter" data-level="6.1.2" data-path="graphs.html"><a href="graphs.html#matlab-graph-titling-labels-and-legends-examples"><i class="fa fa-check"></i><b>6.1.2</b> Matlab Graph Titling, Labels and Legends Examples</a></li>
<li class="chapter" data-level="6.1.3" data-path="graphs.html"><a href="graphs.html#matlab-graph-matrix-with-jet-spectrum-color-label-a-subset-examples"><i class="fa fa-check"></i><b>6.1.3</b> Matlab Graph Matrix with Jet Spectrum Color, Label a Subset Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="graphs.html"><a href="graphs.html#basic-figure-types"><i class="fa fa-check"></i><b>6.2</b> Basic Figure Types</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="graphs.html"><a href="graphs.html#matlab-graph-scatter-plot-examples"><i class="fa fa-check"></i><b>6.2.1</b> Matlab Graph Scatter Plot Examples</a></li>
<li class="chapter" data-level="6.2.2" data-path="graphs.html"><a href="graphs.html#matlab-line-and-scatter-plot-with-multiple-lines-and-axis-lines"><i class="fa fa-check"></i><b>6.2.2</b> Matlab Line and Scatter Plot with Multiple Lines and Axis Lines</a></li>
<li class="chapter" data-level="6.2.3" data-path="graphs.html"><a href="graphs.html#matlab-graph-scatter-and-line-spectrum-with-three-variables"><i class="fa fa-check"></i><b>6.2.3</b> Matlab Graph Scatter and Line Spectrum with Three Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="graphs.html"><a href="graphs.html#graph-functions"><i class="fa fa-check"></i><b>6.3</b> Graph Functions</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="graphs.html"><a href="graphs.html#matlab-graph-one-variable-function"><i class="fa fa-check"></i><b>6.3.1</b> Matlab Graph One Variable Function</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="graphs.html"><a href="graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>6.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="graphs.html"><a href="graphs.html#matlab-graph-generate-eps-postscript-figures-in-matlab"><i class="fa fa-check"></i><b>6.4.1</b> Matlab Graph Generate EPS postscript figures in matlab</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>7</b> Tables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tables.html"><a href="tables.html#basic-table-generation"><i class="fa fa-check"></i><b>7.1</b> Basic Table Generation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="tables.html"><a href="tables.html#generate-a-table-and-fill-with-data-row-by-row-or-random-data"><i class="fa fa-check"></i><b>7.1.1</b> Generate a Table and Fill with Data Row by Row or Random Data</a></li>
<li class="chapter" data-level="7.1.2" data-path="tables.html"><a href="tables.html#tables-order-sort-add-rename-and-drop-columns"><i class="fa fa-check"></i><b>7.1.2</b> Tables Order, Sort, Add, Rename and Drop Columns</a></li>
<li class="chapter" data-level="7.1.3" data-path="tables.html"><a href="tables.html#row-and-column-names-for-table-based-on-arrays"><i class="fa fa-check"></i><b>7.1.3</b> Row and Column Names for Table based on Arrays</a></li>
<li class="chapter" data-level="7.1.4" data-path="tables.html"><a href="tables.html#select-subset-of-rows-and-columns"><i class="fa fa-check"></i><b>7.1.4</b> Select Subset of Rows and Columns</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tables.html"><a href="tables.html#table-joining"><i class="fa fa-check"></i><b>7.2</b> Table Joining</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="tables.html"><a href="tables.html#matlab-join-tables-by-keys"><i class="fa fa-check"></i><b>7.2.1</b> Matlab Join Tables by Keys</a></li>
<li class="chapter" data-level="7.2.2" data-path="tables.html"><a href="tables.html#row-and-column-combine-stack-tables-and-matrices"><i class="fa fa-check"></i><b>7.2.2</b> Row and Column Combine Stack Tables and Matrices</a></li>
<li class="chapter" data-level="7.2.3" data-path="tables.html"><a href="tables.html#matlab-table-stack-and-join-estimation-and-simulation-results"><i class="fa fa-check"></i><b>7.2.3</b> Matlab Table Stack and Join Estimation and Simulation Results</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tables.html"><a href="tables.html#summarize"><i class="fa fa-check"></i><b>7.3</b> Summarize</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="tables.html"><a href="tables.html#matlab-table-summarize-and-aggregate-by-groups"><i class="fa fa-check"></i><b>7.3.1</b> Matlab Table Summarize and Aggregate by Groups</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#data-structures-links"><i class="fa fa-check"></i><b>A.1</b> Data Structures links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-matrices-and-arraysmatrices-and-arrays-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 Matrices and Arrays</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-nd-dimensional-arraysnd-dimensional-arrays-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 ND Dimensional Arrays</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-cellscells-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Cells</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-characters-and-stringscharacters-and-strings-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Characters and Strings</span> links</a></li>
<li class="chapter" data-level="A.1.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.5-map-containersmap-containers-links"><i class="fa fa-check"></i><b>A.1.5</b> <span>Section 1.5 Map Containers</span> links</a></li>
<li class="chapter" data-level="A.1.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.6-map-structure-arraymap-structure-array-links"><i class="fa fa-check"></i><b>A.1.6</b> <span>Section 1.6 Map Structure Array</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-and-programming-links"><i class="fa fa-check"></i><b>A.2</b> Functions and Programming links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-development-and-debuggingdevelopment-and-debugging-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Development and Debugging</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-varargin-default-parametersvarargin-default-parameters-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 varargin Default Parameters</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-dynamic-functionsdynamic-functions-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Dynamic Functions</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#distributional-processes-links"><i class="fa fa-check"></i><b>A.3</b> Distributional Processes links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-time-seriestime-series-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Time Series</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-cross-sectional-datacross-sectional-data-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Cross-sectional Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#simulation-links"><i class="fa fa-check"></i><b>A.4</b> Simulation links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-normal-distributionnormal-distribution-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Normal Distribution</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#estimation-links"><i class="fa fa-check"></i><b>A.5</b> Estimation links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-estimationlinear-estimation-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 Linear Estimation</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-nonlinear-estimationnonlinear-estimation-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Nonlinear Estimation</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#graphs-links"><i class="fa fa-check"></i><b>A.6</b> Graphs links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-figure-componentsfigure-components-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Figure Components</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-basic-figure-typesbasic-figure-types-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Basic Figure Types</span> links</a></li>
<li class="chapter" data-level="A.6.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.3-graph-functionsgraph-functions-links"><i class="fa fa-check"></i><b>A.6.3</b> <span>Section 6.3 Graph Functions</span> links</a></li>
<li class="chapter" data-level="A.6.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.6.4</b> <span>Section 6.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-links"><i class="fa fa-check"></i><b>A.7</b> Tables links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-basic-table-generationbasic-table-generation-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Basic Table Generation</span> links</a></li>
<li class="chapter" data-level="A.7.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.2-table-joiningtable-joining-links"><i class="fa fa-check"></i><b>A.7.2</b> <span>Section 7.2 Table Joining</span> links</a></li>
<li class="chapter" data-level="A.7.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.3-summarizesummarize-links"><i class="fa fa-check"></i><b>A.7.3</b> <span>Section 7.3 Summarize</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/M4Econ/bookdown/index.html" target="blank">M4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures and Dynamic Optimization with Matlab</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-structures" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Data Structures</h1>

<div id="matrices-and-arrays" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Matrices and Arrays</h2>

<div id="array-reshape-repeat-and-expand-examples" class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Array Reshape, Repeat and Expand Examples</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="basic-examples-of-reshape" class="section level4" number="1.1.1.1">
<h4><span class="header-section-number">1.1.1.1</span> Basic Examples of Reshape</h4>
<pre><code>a = [1,2,3,4,5,6]&#39;;
b = reshape(a, [3,2])

b = 3x2    
     1     4
     2     5
     3     6

b(:)

ans = 6x1    
     1
     2
     3
     4
     5
     6

a = [1,2,3;4,5,6;7,8,9;10,11,12]&#39;

a = 3x4    
     1     4     7    10
     2     5     8    11
     3     6     9    12

b = reshape(a, [6,2])

b = 6x2    
     1     7
     2     8
     3     9
     4    10
     5    11
     6    12</code></pre>
</div>
<div id="stack-two-matrix-of-equal-column-count-together" class="section level4" number="1.1.1.2">
<h4><span class="header-section-number">1.1.1.2</span> <strong>Stack Two Matrix of Equal Column Count Together</strong></h4>
<pre><code>a = [1,2;3,4];
a_stacked = [a;a;a];
disp(a_stacked);

     1     2
     3     4
     1     2
     3     4
     1     2
     3     4</code></pre>
</div>
<div id="repeatduplicate-matrix-downwards" class="section level4" number="1.1.1.3">
<h4><span class="header-section-number">1.1.1.3</span> <strong>Repeat/Duplicate Matrix Downwards</strong></h4>
<p>There is a 2 by 3 matrix, to be repeated 4 times, downwards. This is
useful for replicating data matrix for say counterfactual purposes.</p>
<p>Below, we have two ways of repeating a matrix downwards. Copy as whole,
or copy row by row.</p>
<pre><code>row_count = 2;
col_count = 3;
repeat_mat_count = 2;

data_vec = 1:(row_count*col_count);
searchMatrix = reshape(data_vec,row_count,col_count);

% To repeat matrix downwards
rep_rows_idx = [1:row_count]&#39;*ones(1,repeat_mat_count);
rep_rows_idx = rep_rows_idx(:);

rep_cols_idx = [1:col_count];
rep_cols_idx = rep_cols_idx(:);

searchMatrixRep_stack = searchMatrix(rep_rows_idx, rep_cols_idx);

% To insert repeated rows following original rows
rep_rows_idx = ([1:row_count]&#39;*ones(1,repeat_mat_count))&#39;;
rep_rows_idx = rep_rows_idx(:);

searchMatrixRep_dup = searchMatrix(rep_rows_idx, rep_cols_idx);

disp(searchMatrix)

     1     3     5
     2     4     6

disp(searchMatrixRep_stack)

     1     3     5
     2     4     6
     1     3     5
     2     4     6

disp(searchMatrixRep_dup)

     1     3     5
     1     3     5
     2     4     6
     2     4     6</code></pre>
</div>
<div id="index-dimension-transform" class="section level4" number="1.1.1.4">
<h4><span class="header-section-number">1.1.1.4</span> Index Dimension Transform</h4>
<p>it_inner_fin = 5; it_outter_fin = 3;</p>
<p>it_inner_cur = it_outter_fin it_outter_cur = it_inner_fin</p>
<p>ar_it_cols_idx = 1:1:(it_inner_fin*it_outter_fin) ar_it_cols_inner_dim
= repmat(1:it_inner_cur, <span class="math display">\[it_outter_cur, 1\]</span>) ar_it_cols_inner_dim(:)’</p>
<p>mt_it_cols_idx = reshape(ar_it_cols_idx, <span class="math display">\[it_inner_cur,
it_outter_cur\]</span>)’ mt_it_cols_idx(:)’</p>
<pre><code>it_inner_fin = 5;
it_outter_fin = 3;

ar_it_cols_idx = 1:1:(it_inner_fin*it_outter_fin)

ar_it_cols_idx = 1x15    
     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15

mt_it_cols_idx = reshape(ar_it_cols_idx, [it_outter_fin, it_inner_fin])&#39;

mt_it_cols_idx = 5x3    
     1     2     3
     4     5     6
     7     8     9
    10    11    12
    13    14    15

mt_it_cols_idx(:)&#39;

ans = 1x15    
     1     4     7    10    13     2     5     8    11    14     3     6     9    12    15</code></pre>

</div>
</div>
<div id="array-index-slicing-and-subsetting-to-replace-and-expand" class="section level3" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Array Index Slicing and Subsetting to Replace and Expand</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="find-the-first-negative-element-of-array" class="section level4" number="1.1.2.1">
<h4><span class="header-section-number">1.1.2.1</span> Find the First Negative Element of Array</h4>
<p>There is an array with positive, negative and NaN values, find the first
negative number’s index, and the last positive number index. Use the
find function.</p>
<pre><code>for it_array=1:1:2
    % Construct Array
    if (it_array == 1) 
        ar_alpha_sum_devi_one = [0.1, 0.7, -0.001, NaN, NaN];
    elseif (it_array ==2)
        ar_alpha_sum_devi_one = [0.1, 0.7, 0.001, NaN, NaN];
    end
    % Find last positive
    it_last_pos_idx = find(ar_alpha_sum_devi_one &gt; 0, 1, &#39;last&#39;);
    % Find first negative
    it_first_neg_idx = find(ar_alpha_sum_devi_one &lt; 0, 1, &#39;first&#39;);
    if (isempty(it_first_neg_idx))
        it_first_neg_idx = NaN;
    end
    disp([&#39;it_last_pos_idx=&#39; num2str(it_last_pos_idx) ...
        &#39;, it_first_neg_idx=&#39; num2str(it_first_neg_idx)])
end

it_last_pos_idx=2, it_first_neg_idx=3
it_last_pos_idx=3, it_first_neg_idx=NaN</code></pre>
</div>
<div id="first-the-first-negative-element-of-last-segment-of-array" class="section level4" number="1.1.2.2">
<h4><span class="header-section-number">1.1.2.2</span> First the First Negative Element of Last Segment of Array</h4>
<p>There is an array with some negative numbers, then some positive
numbers, then some negative numbers again. Find the first element of the
final segment of negative numbers.</p>
<pre><code>for it_array=1:5
    
    % Construct Array
    if (it_array == 1) 
        ar_alpha_sum_devi_one = [0.1, 0.7, -0.001, NaN, NaN];
    elseif (it_array ==2)
        ar_alpha_sum_devi_one = [0.1, 0.7, 0.001, NaN, NaN];
    elseif (it_array ==3)
        ar_alpha_sum_devi_one = [-0.001, 0.1, 0.7, 0.001, NaN, NaN];
    elseif (it_array ==4)
        ar_alpha_sum_devi_one = [-0.001, 0.1, 0.7, 0.001, -0.0002, -0.05, NaN, NaN];
    elseif (it_array ==5)
        ar_alpha_sum_devi_one = [NaN, NaN, -0.001, 0.1, 0.7, 0.001, -0.0002, NaN];
    end
    
    % Find last positive
    it_last_pos_idx = find(ar_alpha_sum_devi_one &gt; 0, 1, &#39;last&#39;);
    % Find first negative
    it_first_neg_idx = find(ar_alpha_sum_devi_one &lt; 0, 1, &#39;first&#39;);
    % Find first negative of last negative segment
    ar_alpha_sum_after_last_pos = ...
        ar_alpha_sum_devi_one(it_last_pos_idx:length(ar_alpha_sum_devi_one));
    it_first_neg_last_neg_seg_idx = it_last_pos_idx - 1 + ...
        find(ar_alpha_sum_after_last_pos &lt; 0, 1, &#39;first&#39;);
    
    if (isempty(it_first_neg_idx))
        it_first_neg_idx = NaN;
    end
    if (isempty(it_first_neg_last_neg_seg_idx))
        it_first_neg_last_neg_seg_idx = NaN;
    end
    
    disp([&#39;it_last_pos_idx=&#39; num2str(it_last_pos_idx) ...
        &#39;, it_first_neg_idx=&#39; num2str(it_first_neg_idx)... 
        &#39;, it_first_neg_last_neg_seg_idx=&#39; num2str(it_first_neg_last_neg_seg_idx)])
end

it_last_pos_idx=2, it_first_neg_idx=3, it_first_neg_last_neg_seg_idx=3
it_last_pos_idx=3, it_first_neg_idx=NaN, it_first_neg_last_neg_seg_idx=NaN
it_last_pos_idx=4, it_first_neg_idx=1, it_first_neg_last_neg_seg_idx=NaN
it_last_pos_idx=4, it_first_neg_idx=1, it_first_neg_last_neg_seg_idx=5
it_last_pos_idx=6, it_first_neg_idx=3, it_first_neg_last_neg_seg_idx=7</code></pre>
</div>
<div id="index-select-rows-and-columns-of-a-2d-matrix" class="section level4" number="1.1.2.3">
<h4><span class="header-section-number">1.1.2.3</span> Index Select Rows and Columns of a 2D matrix</h4>
<p>In the example below, select by entire rows and columns:</p>
<pre><code>% There is a 2D Matrix
rng(123);
randMatZ = rand(3,6);
disp(randMatZ);

    0.6965    0.5513    0.9808    0.3921    0.4386    0.7380
    0.2861    0.7195    0.6848    0.3432    0.0597    0.1825
    0.2269    0.4231    0.4809    0.7290    0.3980    0.1755

% Duplicate Select Row sand Columns of Elements
disp(randMatZ([1,2,3,3,3,2], [1,1,2,2,2,1]))

    0.6965    0.6965    0.5513    0.5513    0.5513    0.6965
    0.2861    0.2861    0.7195    0.7195    0.7195    0.2861
    0.2269    0.2269    0.4231    0.4231    0.4231    0.2269
    0.2269    0.2269    0.4231    0.4231    0.4231    0.2269
    0.2269    0.2269    0.4231    0.4231    0.4231    0.2269
    0.2861    0.2861    0.7195    0.7195    0.7195    0.2861</code></pre>
</div>
<div id="index-select-set-of-elements-from-2d-matrix" class="section level4" number="1.1.2.4">
<h4><span class="header-section-number">1.1.2.4</span> Index Select Set of Elements from 2D matrix</h4>
<p>Rather than selecting entire rows and columns, suppose we want to select
only one element at row 1 col 2, the element at row 2 col 4, element at
row 5 col 1, etc.</p>
<pre><code>% Select Subset of Elements
it_row_idx = [1,2,3,1,3,2];
it_col_idx = [1,1,5,4,2,3];
% Select sub2idx
ar_lin_idx = sub2ind(size(randMatZ), it_row_idx, it_col_idx);
ar_sel_val = randMatZ(ar_lin_idx);
disp(ar_sel_val&#39;);

    0.6965
    0.2861
    0.3980
    0.3921
    0.4231
    0.6848</code></pre>
</div>
<div id="find-closest-element-of-array-to-each-element-of-another-array" class="section level4" number="1.1.2.5">
<h4><span class="header-section-number">1.1.2.5</span> Find Closest Element of Array to Each Element of Another Array</h4>
<p>Given scalar value, find the cloest value in array:</p>
<pre><code>fl_a = 3.4;
ar_bb = [1,2,3,4];
[fl_min, it_min_idx] = min(abs(ar_bb-fl_a));
disp(it_min_idx);

     3</code></pre>
<p>Given a scalar value and an array, find the closest smaller value in the
array to the scalar value:</p>
<pre><code>fl_a = 2.1;
ar_bb = [1,2,3,4];
disp(sum(ar_bb&lt;fl_a));

     2</code></pre>
<p>Array A is between 0 and 1, on some grid. Array B is also between 0 and
1, but scattered. Find for each element of B the index of the cloest
value on A that is smaller than the element in B.</p>
<pre><code>rng(1234);
ar_a = linspace(0,10,5);
ar_b = rand([5,1])*10;
mt_a_less_b = ar_a&lt;ar_b;
mt_a_less_b_idx = sum(ar_a&lt;ar_b, 2);
disp(ar_a);

         0    2.5000    5.0000    7.5000   10.0000

disp(ar_b);

    1.9152
    6.2211
    4.3773
    7.8536
    7.7998

disp(mt_a_less_b);

   1   0   0   0   0
   1   1   1   0   0
   1   1   0   0   0
   1   1   1   1   0
   1   1   1   1   0

disp(mt_a_less_b_idx);

     1
     3
     2
     4
     4</code></pre>
</div>
<div id="matlab-index-based-replacement-of-subset-of-matrix-values" class="section level4" number="1.1.2.6">
<h4><span class="header-section-number">1.1.2.6</span> Matlab Index based Replacement of Subset of Matrix Values</h4>
<pre><code>rng(123);
randMatZ = rand(3,6)+1;
randMat = rand(3,6)-0.5;
 
output = max(-randMat,0);
randMatZ(output==0) = 999;
min(randMatZ,[],2);
 randMatZ((max(-randMat,0))==0) = 999;
disp(randMatZ);

  999.0000  999.0000  999.0000    1.3921    1.4386    1.7380
  999.0000  999.0000    1.6848    1.3432    1.0597    1.1825
  999.0000  999.0000    1.4809  999.0000    1.3980    1.1755

disp(min(randMatZ,[],2));

    1.3921
    1.0597
    1.1755</code></pre>
</div>
<div id="matlab-matrix-index-based-matrix-expansion-manual" class="section level4" number="1.1.2.7">
<h4><span class="header-section-number">1.1.2.7</span> Matlab Matrix Index Based Matrix Expansion (Manual)</h4>
<p>In the example below, we start with a 4 by 2 matrix, than we expand
specific rows and columns of the matrix. Specifically, we expand the
matrix such that the result matrix repeats the 1st, 2nd, 1st, 2nd, then
3rd, than 1st, 1st, and 1st rows. And repeats column 1, then 2nd, then
2nd, then 2nd, and finally the first column.</p>
<pre><code>% Original Matrix
Z = 2;
N = 2;
Q = 2;
base_mat = reshape(1:(Z*N*Q),Z*N,Q);
disp(base_mat);

     1     5
     2     6
     3     7
     4     8

% Expanded Matrix
base_expand = base_mat([1,2,1,2,3,1,1,1],[1,2,2,2,1]);
disp(base_expand);

     1     5     5     5     1
     2     6     6     6     2
     1     5     5     5     1
     2     6     6     6     2
     3     7     7     7     3
     1     5     5     5     1
     1     5     5     5     1
     1     5     5     5     1</code></pre>
</div>
<div id="duplicate-matrix-downwards-n-times-using-index" class="section level4" number="1.1.2.8">
<h4><span class="header-section-number">1.1.2.8</span> Duplicate Matrix Downwards N times Using Index</h4>
<p>The example here has the same idea, but we do the operations above in a
more automated way. This could be done using alternative methods.</p>
<pre><code>% Original Matrix
Z = 2;
N = 2;
Q = 2;
base_mat = reshape(1:(Z*N*Q),Z*N,Q);
disp(base_mat);

     1     5
     2     6
     3     7
     4     8

% Generate row Index many times automatically depending on how many times
% to replicate
vmat_repeat_count = 3;
vmat_reindex_rows_repeat = [1:(Z*N)]&#39;* ones(1,vmat_repeat_count);
vmat_reindex_rows_repeat = vmat_reindex_rows_repeat(:);
disp(vmat_reindex_rows_repeat&#39;);

     1     2     3     4     1     2     3     4     1     2     3     4

% Duplicate Matrix by the Rows specified above, and using the same number
% of columns.
mat_repdown = base_mat(vmat_reindex_rows_repeat(:), 1:Q);
disp(mat_repdown&#39;);

     1     2     3     4     1     2     3     4     1     2     3     4
     5     6     7     8     5     6     7     8     5     6     7     8</code></pre>
</div>
<div id="given-nd-array-get-row-and-column-and-other-dimension-index-with-value-conditioning" class="section level4" number="1.1.2.9">
<h4><span class="header-section-number">1.1.2.9</span> Given ND Array, Get Row and Column (and other dimension) Index With Value Conditioning</h4>
<p>There is a matrix where some values are equal to 1 (based on some prior
selection), get the row and column index of the matrix.</p>
<pre><code>% Some matrix with 1s
rng(123);
mt_some_ones = rand(3,3);
disp(mt_some_ones);

    0.6965    0.5513    0.9808
    0.2861    0.7195    0.6848
    0.2269    0.4231    0.4809

% find the location of the ones
[r_idx, c_idx] = find(mt_some_ones&lt;0.5);
% the set of locations
disp([r_idx,c_idx]);

     2     1
     3     1
     3     2
     3     3</code></pre>
<p>Now do the same three with a three dimensional array:</p>
<pre><code>% Some matrix with 1s
rng(123);
mn3_some_ones = rand(3,3,3);
disp(mn3_some_ones);

(:,:,1) =

    0.6965    0.5513    0.9808
    0.2861    0.7195    0.6848
    0.2269    0.4231    0.4809


(:,:,2) =

    0.3921    0.4386    0.7380
    0.3432    0.0597    0.1825
    0.7290    0.3980    0.1755


(:,:,3) =

    0.5316    0.8494    0.7224
    0.5318    0.7245    0.3230
    0.6344    0.6110    0.3618

% find the location of the ones
[d1_idx, d2_idx, d3_idx] = ind2sub(size(mn3_some_ones), find(mn3_some_ones&lt;0.5));
% the set of locations
disp([d1_idx, d2_idx, d3_idx]);

     2     1     1
     3     1     1
     3     2     1
     3     3     1
     1     1     2
     2     1     2
     1     2     2
     2     2     2
     3     2     2
     2     3     2
     3     3     2
     2     3     3
     3     3     3</code></pre>
</div>
<div id="max-of-matrix-column-by-column-linear-to-2d-index" class="section level4" number="1.1.2.10">
<h4><span class="header-section-number">1.1.2.10</span> Max of Matrix column by Column Linear to 2d Index</h4>
<p>Finding max of matrix column by column, then obtain the linear index
associated with the max values.</p>
<pre><code>randMat = rand(5,3);
disp(randMat);

    0.2283    0.4309    0.8934
    0.2937    0.4937    0.9442
    0.6310    0.4258    0.5018
    0.0921    0.3123    0.6240
    0.4337    0.4264    0.1156

[maxVal maxIndex] = max(randMat);
linearIndex = sub2ind(size(randMat),maxIndex,(1:1:size(randMat,2)))

linearIndex = 1x3    
     3     7    12

randMat(linearIndex)

ans = 1x3    
    0.6310    0.4937    0.9442

t_pV = [1,2;3,4;5,6];
t_pV_Ind = [1,1;0,0;1,1];
[maxVal maxIndex] = max(t_pV(t_pV_Ind==1))

maxVal = 6
maxIndex = 4</code></pre>
</div>
<div id="given-array-of-size-m-select-n-somewhat-equi-distance-elements" class="section level4" number="1.1.2.11">
<h4><span class="header-section-number">1.1.2.11</span> Given Array of size M, Select N somewhat equi-distance elements</h4>
<pre><code>% Subset count
it_n = 5;

% Example 1, long array
ar_fl_a = 1:1.1:100;
ar_it_subset_idx = unique(round(((0:1:(it_n-1))/(it_n-1))*(length(ar_fl_a)-1)+1));
ar_fl_a_subset = ar_fl_a(ar_it_subset_idx);
disp(ar_fl_a_subset);

    1.0000   26.3000   50.5000   75.8000  100.0000


% Example 2, Short Array
ar_fl_a = 1:1.1:3;
ar_it_subset_idx = unique(round(((0:1:(it_n-1))/(it_n-1))*(length(ar_fl_a)-1)+1));
ar_fl_a_subset = ar_fl_a(ar_it_subset_idx);
disp(ar_fl_a_subset);

    1.0000    2.1000


% Write As function
f_subset = @(it_subset_n, it_ar_n) unique(round(((0:1:(it_subset_n-1))/(it_subset_n-1))*(it_ar_n-1)+1));

% Select 5 out of 10
disp(f_subset(5, 10));

     1     3     6     8    10


% Select 10 out of 5
disp(f_subset(10, 5));

     1     2     3     4     5


% Select 5 out of 5
disp(f_subset(5, 5));

     1     2     3     4     5</code></pre>

</div>
</div>
<div id="maximum-of-matrix-columns-sort-matrix-columns" class="section level3" number="1.1.3">
<h3><span class="header-section-number">1.1.3</span> Maximum of Matrix Columns, Sort Matrix Columns</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="max-value-from-a-matrix" class="section level4" number="1.1.3.1">
<h4><span class="header-section-number">1.1.3.1</span> Max Value from a Matrix</h4>
<p>Given a matrix of values, what is the maximum element, what are the row
and column indexes of this max element of the matrix.</p>
<pre><code>rng(123);
N = 3;
M = 4;
mt_rand = rand(M,N);
disp(mt_rand);

    0.6965    0.7195    0.4809
    0.2861    0.4231    0.3921
    0.2269    0.9808    0.3432
    0.5513    0.6848    0.7290

[max_val, max_idx] = max(mt_rand(:));
[max_row, max_col] = ind2sub(size(mt_rand), max_idx)

max_row = 3
max_col = 2</code></pre>
</div>
<div id="max-value-from-each-column" class="section level4" number="1.1.3.2">
<h4><span class="header-section-number">1.1.3.2</span> MAX Value from Each Column</h4>
<p>There is a matrix with N columns, and M rows, with numerical values.
Generate a table of sorted index, indicating in each column which row
was the highest in value, second highest, etc. (1) sort each column. (2)
show the row number from descending or ascending sort for each column as
a matrix.</p>
<pre><code>% Create a 2D Array
rng(123);
N = 2;
M = 4;
mt_rand = rand(M,N);
disp(mt_rand);

    0.6965    0.7195
    0.2861    0.4231
    0.2269    0.9808
    0.5513    0.6848</code></pre>
<p>Use the maxk function to generate sorted index:</p>
<pre><code>% maxk function
[val, idx] = max(mt_rand);
disp(val);

    0.6965    0.9808

disp(idx);

     1     3</code></pre>
</div>
<div id="maxk-sorted-sorted-index-for-each-column-of-matrix" class="section level4" number="1.1.3.3">
<h4><span class="header-section-number">1.1.3.3</span> MAXK Sorted Sorted Index for Each Column of Matrix</h4>
<p>There is a matrix with N columns, and M rows, with numerical values.
Generate a table of sorted index, indicating in each column which row
was the highest in value, second highest, etc. (1) sort each column. (2)
show the row number from descending or ascending sort for each column as
a matrix.</p>
<pre><code>% Create a 2D Array
rng(123);
N = 2;
M = 4;
mt_rand = rand(M,N);
disp(mt_rand);

    0.6965    0.7195
    0.2861    0.4231
    0.2269    0.9808
    0.5513    0.6848</code></pre>
<p>Use the maxk function to generate sorted index:</p>
<pre><code>% maxk function
[val, idx] = maxk(mt_rand, M);
disp(val);

    0.6965    0.9808
    0.5513    0.7195
    0.2861    0.6848
    0.2269    0.4231

disp(idx);

     1     3
     4     1
     2     4
     3     2</code></pre>

</div>
</div>
<div id="array-broadcast-and-expansion-examples" class="section level3" number="1.1.4">
<h3><span class="header-section-number">1.1.4</span> Array Broadcast and Expansion Examples</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Matrix broadcasting was added to matlab’s recent editions. This is an
important step for vectorizing codes. Proper usage of broadcasting
reduces memory allocation requirements for matrix matrix operations.</p>
<div id="broadcasting-with-a-row-and-a-column" class="section level4" number="1.1.4.1">
<h4><span class="header-section-number">1.1.4.1</span> Broadcasting with A Row and a Column</h4>
<p>Below we add together a 1 by 3 and 4 by 1 array, that should not work.
With broadcasting, it is assumed that we will mesh the arrays and then
sum up the meshed matrixes.</p>
<pre><code>clear all
ar_A = [1,2,3];
ar_B = [4,3,2,1]&#39;;
disp(size(ar_A));

     1     3

disp(size(ar_B));

     4     1

mt_A_B_broadcast = ar_A + ar_B;
disp(mt_A_B_broadcast);

     5     6     7
     4     5     6
     3     4     5
     2     3     4

mt_A_B_broadcast_product = ar_A.*ar_B;
disp(mt_A_B_broadcast_product);

     4     8    12
     3     6     9
     2     4     6
     1     2     3</code></pre>
</div>
<div id="broadcasting-with-one-row-and-one-matrix" class="section level4" number="1.1.4.2">
<h4><span class="header-section-number">1.1.4.2</span> Broadcasting with One Row and One Matrix</h4>
<p>Below we add together a 1 by 3 and 4 by 3 matrix, that should not work.
With broadcasting, it is assumed that we will repeat the array four
times, duplicating the single row four times, so the matrix dimensions
match up.</p>
<pre><code>clear all
ar_A = [1,2,3];
mt_B = [4,3,2,1;5,4,3,2;6,5,4,3]&#39;;
disp(size(ar_A));

     1     3

disp(size(mt_B));

     4     3

mt_A_B_broadcast = ar_A + mt_B;
disp(mt_A_B_broadcast);

     5     7     9
     4     6     8
     3     5     7
     2     4     6

mt_A_B_broadcast_product = ar_A.*mt_B;
disp(mt_A_B_broadcast_product);

     4    10    18
     3     8    15
     2     6    12
     1     4     9</code></pre>
</div>
<div id="broadcasting-with-one-column-and-one-matrix" class="section level4" number="1.1.4.3">
<h4><span class="header-section-number">1.1.4.3</span> Broadcasting with One Column and One Matrix</h4>
<p>Below we add together a 4 by 1 and 4 by 3 matrix, that should not work.
With broadcasting, it is assumed that we will repeat the column three
times, duplicating the single column three times, so the matrix
dimensions match up.</p>
<pre><code>clear all
ar_A = [4,3,2,1]&#39;;
mt_B = [4,3,2,1;5,4,3,2;6,5,4,3]&#39;;
disp(size(ar_A));

     4     1

disp(size(mt_B));

     4     3

mt_A_B_broadcast = ar_A + mt_B;
disp(mt_A_B_broadcast);

     8     9    10
     6     7     8
     4     5     6
     2     3     4

mt_A_B_broadcast_product = ar_A.*mt_B;
disp(mt_A_B_broadcast_product);

    16    20    24
     9    12    15
     4     6     8
     1     2     3</code></pre>
</div>
<div id="expand-with-broadcast-percentage-choice-grids" class="section level4" number="1.1.4.4">
<h4><span class="header-section-number">1.1.4.4</span> Expand with Broadcast, Percentage Choice grids</h4>
<pre><code>clear all
ar_w_perc = [0.1,0.5,0.9]

ar_w_perc = 1x3    
    0.1000    0.5000    0.9000

ar_w_level = [-2,0,2]

ar_w_level = 1x3    
    -2     0     2

fl_b_bd = -4

fl_b_bd = -4

ar_k_max = ar_w_level - fl_b_bd

ar_k_max = 1x3    
     2     4     6

ar_ak_perc = [0.1,0.3,0.7,0.9]

ar_ak_perc = 1x4    
    0.1000    0.3000    0.7000    0.9000

mt_k = (ar_k_max&#39;*ar_ak_perc)&#39;

mt_k = 4x3    
    0.2000    0.4000    0.6000
    0.6000    1.2000    1.8000
    1.4000    2.8000    4.2000
    1.8000    3.6000    5.4000

mt_a = (ar_w_level - mt_k)

mt_a = 4x3    
   -2.2000   -0.4000    1.4000
   -2.6000   -1.2000    0.2000
   -3.4000   -2.8000   -2.2000
   -3.8000   -3.6000   -3.4000</code></pre>
</div>
<div id="expand-matrix-twice" class="section level4" number="1.1.4.5">
<h4><span class="header-section-number">1.1.4.5</span> Expand Matrix Twice</h4>
<pre><code>clear all
% Same as above
ar_w_level = [-2,-1,-0.1]

ar_w_level = 1x3    
   -2.0000   -1.0000   -0.1000

fl_b_bd = -4

fl_b_bd = -4

ar_k_max = ar_w_level - fl_b_bd

ar_k_max = 1x3    
    2.0000    3.0000    3.9000

ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]

ar_ak_perc = 1x6    
    0.0010    0.1000    0.3000    0.7000    0.9000    0.9990

mt_k = (ar_k_max&#39;*ar_ak_perc)&#39;

mt_k = 6x3    
    0.0020    0.0030    0.0039
    0.2000    0.3000    0.3900
    0.6000    0.9000    1.1700
    1.4000    2.1000    2.7300
    1.8000    2.7000    3.5100
    1.9980    2.9970    3.8961

mt_a = (ar_w_level - mt_k)

mt_a = 6x3    
   -2.0020   -1.0030   -0.1039
   -2.2000   -1.3000   -0.4900
   -2.6000   -1.9000   -1.2700
   -3.4000   -3.1000   -2.8300
   -3.8000   -3.7000   -3.6100
   -3.9980   -3.9970   -3.9961


% fraction of borrowing for bridge loan
ar_coh_bridge_perc = [0, 0.5, 0.999];

% Expand matrix to include coh percentage dimension
mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])

mt_k = 6x9    
    0.0020    0.0030    0.0039    0.0020    0.0030    0.0039    0.0020    0.0030    0.0039
    0.2000    0.3000    0.3900    0.2000    0.3000    0.3900    0.2000    0.3000    0.3900
    0.6000    0.9000    1.1700    0.6000    0.9000    1.1700    0.6000    0.9000    1.1700
    1.4000    2.1000    2.7300    1.4000    2.1000    2.7300    1.4000    2.1000    2.7300
    1.8000    2.7000    3.5100    1.8000    2.7000    3.5100    1.8000    2.7000    3.5100
    1.9980    2.9970    3.8961    1.9980    2.9970    3.8961    1.9980    2.9970    3.8961

mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])

mt_a = 6x9    
   -2.0020   -1.0030   -0.1039   -2.0020   -1.0030   -0.1039   -2.0020   -1.0030   -0.1039
   -2.2000   -1.3000   -0.4900   -2.2000   -1.3000   -0.4900   -2.2000   -1.3000   -0.4900
   -2.6000   -1.9000   -1.2700   -2.6000   -1.9000   -1.2700   -2.6000   -1.9000   -1.2700
   -3.4000   -3.1000   -2.8300   -3.4000   -3.1000   -2.8300   -3.4000   -3.1000   -2.8300
   -3.8000   -3.7000   -3.6100   -3.8000   -3.7000   -3.6100   -3.8000   -3.7000   -3.6100
   -3.9980   -3.9970   -3.9961   -3.9980   -3.9970   -3.9961   -3.9980   -3.9970   -3.9961

mt_a = mt_a

mt_a = 6x9    
   -2.0020   -1.0030   -0.1039   -2.0020   -1.0030   -0.1039   -2.0020   -1.0030   -0.1039
   -2.2000   -1.3000   -0.4900   -2.2000   -1.3000   -0.4900   -2.2000   -1.3000   -0.4900
   -2.6000   -1.9000   -1.2700   -2.6000   -1.9000   -1.2700   -2.6000   -1.9000   -1.2700
   -3.4000   -3.1000   -2.8300   -3.4000   -3.1000   -2.8300   -3.4000   -3.1000   -2.8300
   -3.8000   -3.7000   -3.6100   -3.8000   -3.7000   -3.6100   -3.8000   -3.7000   -3.6100
   -3.9980   -3.9970   -3.9961   -3.9980   -3.9970   -3.9961   -3.9980   -3.9970   -3.9961


% bridge loan component of borrowing
ar_brdige_a = (ar_coh_bridge_perc&#39;*ar_w_level)&#39;

ar_brdige_a = 3x3    
         0   -1.0000   -1.9980
         0   -0.5000   -0.9990
         0   -0.0500   -0.0999

ar_brdige_a = ar_brdige_a(:)&#39;

ar_brdige_a = 1x9    
         0         0         0   -1.0000   -0.5000   -0.0500   -1.9980   -0.9990   -0.0999


% borrowing choices excluding bridge loan
mt_a_nobridge = mt_a - ar_brdige_a

mt_a_nobridge = 6x9    
   -2.0020   -1.0030   -0.1039   -1.0020   -0.5030   -0.0539   -0.0040   -0.0040   -0.0040
   -2.2000   -1.3000   -0.4900   -1.2000   -0.8000   -0.4400   -0.2020   -0.3010   -0.3901
   -2.6000   -1.9000   -1.2700   -1.6000   -1.4000   -1.2200   -0.6020   -0.9010   -1.1701
   -3.4000   -3.1000   -2.8300   -2.4000   -2.6000   -2.7800   -1.4020   -2.1010   -2.7301
   -3.8000   -3.7000   -3.6100   -2.8000   -3.2000   -3.5600   -1.8020   -2.7010   -3.5101
   -3.9980   -3.9970   -3.9961   -2.9980   -3.4970   -3.9461   -2.0000   -2.9980   -3.8962</code></pre>

</div>
</div>
<div id="grid-states-choices-and-optimal-choices-example" class="section level3" number="1.1.5">
<h3><span class="header-section-number">1.1.5</span> Grid States, Choices and Optimal Choices Example</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="generate-state-grid" class="section level4" number="1.1.5.1">
<h4><span class="header-section-number">1.1.5.1</span> <strong>Generate State Grid</strong></h4>
<p>There many multiple individuals, each individual’s value for each state
space variable is different. We duplicate that by shockCount and
choicecount:</p>
<pre><code>stateCount = 2;
shockCount = 3;
choiceCount = 4;

state1 = rand(1,stateCount)

state1 = 1x2    
    0.0571    0.6694

states1ShkDup = state1(ones(shockCount*choiceCount,1),:)

states1ShkDup = 12x2    
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694
    0.0571    0.6694

states1ShkDup(:)

ans = 24x1    
    0.0571
    0.0571
    0.0571
    0.0571
    0.0571
    0.0571
    0.0571
    0.0571
    0.0571
    0.0571</code></pre>
</div>
<div id="generate-choices" class="section level4" number="1.1.5.2">
<h4><span class="header-section-number">1.1.5.2</span> <strong>Generate Choices</strong></h4>
<p>Generate Choice Grid, Example: Each individual has minimal protein and
maximal protein they can get Generate a evenly set grid of choices for
each individual from min to max. Individual min and max choice is a
function of some component of their state-space, such as wealth/income
level, and choice is the quantity of good to purchase.</p>
<pre><code>stateCount = 2;
shockCount = 3;
choiceCount = 4;

% 1. Min and Max Choices for each state
minprot_n = floor(rand(1,stateCount)*10)

minprot_n = 1x2    
     7     7

maxprot_n = minprot_n + floor(rand(1,stateCount)*10)

maxprot_n = 1x2    
    14    12

% 2. Choice Ratios, ratios of max-min difference
protChoiceGrid = linspace(0,1,choiceCount)

protChoiceGrid = 1x4    
         0    0.3333    0.6667    1.0000

% 3. Each column is a different state.
searchMatrix = (protChoiceGrid&#39;*(maxprot_n-minprot_n)+minprot_n(ones(choiceCount,1),:))

searchMatrix = 4x2    
    7.0000    7.0000
    9.3333    8.6667
   11.6667   10.3333
   14.0000   12.0000

% 4. Each column is a different state, each set of rows is a different shock% for the state. In this structure, shocks (to preference for example), do% not change choice grid for a given state
searchMatrix = searchMatrix([1:choiceCount]&#39;* ones(1,shockCount), [1:stateCount]&#39; * ones(1,1))

searchMatrix = 12x2    
    7.0000    7.0000
    9.3333    8.6667
   11.6667   10.3333
   14.0000   12.0000
    7.0000    7.0000
    9.3333    8.6667
   11.6667   10.3333
   14.0000   12.0000
    7.0000    7.0000
    9.3333    8.6667

searchMatrix(:)

ans = 24x1    
    7.0000
    9.3333
   11.6667
   14.0000
    7.0000
    9.3333
   11.6667
   14.0000
    7.0000
    9.3333</code></pre>
</div>
<div id="average-utility-over-shocks" class="section level4" number="1.1.5.3">
<h4><span class="header-section-number">1.1.5.3</span> <strong>Average Utility over Shocks</strong></h4>
<p>Average of Shocks, E(value) For each STATE and CHOICE, x number of
shocks. Need to average over shocks; The raw value output is: STATES *
SHOCKS * CHOICES; Code below turn into various things, see MATLAB CODE
STRUCTURE in oneNOTE GCC working notes</p>
<pre><code>shockCount = 2;
choiceCount = 3;
stateCount = 4;

% 1. VALUE vector (STATES * SHOCKS * CHOICES by 1), this is generated by utility% evaluation function that takes as input STATES, SHOCKS, and CHOICES
valuesOri = sort(rand(choiceCount*shockCount*stateCount,1))

valuesOri = 24x1    
    0.0296
    0.1141
    0.1472
    0.1514
    0.1826
    0.1936
    0.2526
    0.2911
    0.3257
    0.3352

% 2. CHOICES by STATES * SHOCKS (ST1 SK1, ST1 SK2; ST2 SK1, etc), each% column are values for different choices given the same state and shock.
values = reshape(valuesOri,[choiceCount,shockCount*stateCount])

values = 3x8    
    0.0296    0.1514    0.2526    0.3352    0.5939    0.7065    0.8791    0.9204
    0.1141    0.1826    0.2911    0.3480    0.5992    0.7267    0.9001    0.9508
    0.1472    0.1936    0.3257    0.4578    0.6576    0.7792    0.9018    0.9658

% 3. SHOCKS by CHOICES * STATES (CH1 ST1, CH1 ST2; CH2 ST1, etc), each% column are two shocks for each state given the same choice. Note this% assumes that for different shocks of the same state choice vector is the% same.
values = reshape(values&#39;,[shockCount, choiceCount*stateCount])

values = 2x12    
    0.0296    0.2526    0.5939    0.8791    0.1141    0.2911    0.5992    0.9001    0.1472    0.3257    0.6576    0.9018
    0.1514    0.3352    0.7065    0.9204    0.1826    0.3480    0.7267    0.9508    0.1936    0.4578    0.7792    0.9658

% 4. AVG: 1 by CHOICES * STATES (CH1 ST1, CH1 ST2; CH2 ST1, etc), take% average over shocks for each state and choice combo
valuesMn = mean(values,1)

valuesMn = 1x12    
    0.0905    0.2939    0.6502    0.8997    0.1483    0.3196    0.6629    0.9254    0.1704    0.3918    0.7184    0.9338

% 5. AVG: CHOICES * STATES. From this matrix, one can now pick maximum% utility, and match that to the index on choice vector
valuesMn = reshape(valuesMn, [stateCount, choiceCount])&#39;

valuesMn = 3x4    
    0.0905    0.2939    0.6502    0.8997
    0.1483    0.3196    0.6629    0.9254
    0.1704    0.3918    0.7184    0.9338</code></pre>
</div>
<div id="pick-optimal-choice" class="section level4" number="1.1.5.4">
<h4><span class="header-section-number">1.1.5.4</span> <strong>Pick Optimal Choice</strong></h4>
<pre><code>choiceCount = 3;
stateCount = 4;

% 1. Matrix, each column is a state, each row is a choice
randMat = rand(choiceCount,stateCount)

randMat = 3x4    
    0.0733    0.5905    0.1731    0.1795
    0.0550    0.8539    0.1340    0.3175
    0.3232    0.2871    0.9947    0.5683

% 2. Maximum Value and Maximum Index
[maxVal maxIndex] = max(randMat)

maxVal = 1x4    
    0.3232    0.8539    0.9947    0.5683

maxIndex = 1x4    
     3     2     3     3

% 3. Linear index
linearIdx = maxIndex + ((1:stateCount)-1)*choiceCount

linearIdx = 1x4    
     3     5     9    12

% 4. Optimal Choices
randMat(linearIdx)

ans = 1x4    
    0.3232    0.8539    0.9947    0.5683</code></pre>

</div>
</div>
<div id="accumarray-examples" class="section level3" number="1.1.6">
<h3><span class="header-section-number">1.1.6</span> Accumarray Examples</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="accumarry-basic-example" class="section level4" number="1.1.6.1">
<h4><span class="header-section-number">1.1.6.1</span> Accumarry Basic Example</h4>
<p>There are three unique values in ar_a, sum up the probabilities for each
of the unique states. This is equivalent to sorting a matrix with a and
prob, and computing sum for each.</p>
<pre><code>ar_a = [3,2,1,3]&#39;;
ar_prob = [0.1,0.2,0.31,0.39]&#39;;
ar_sumprob = accumarray(ar_a, ar_prob);
tb_summed_prob = table(sort(unique(ar_a)), ar_sumprob);
disp(tb_summed_prob);

    Var1    ar_sumprob
    ____    __________

     1         0.31   
     2          0.2   
     3         0.49   </code></pre>
</div>
<div id="accumarry-for-discrete-random-variable" class="section level4" number="1.1.6.2">
<h4><span class="header-section-number">1.1.6.2</span> Accumarry For Discrete Random Variable</h4>
<p>Upon solving a model, if we look for the mass at certain choices or
states, accumarray could help aggregate up probabilities</p>
<pre><code>a1 = [1,1,2,2]

a1 = 1x4    
     1     1     2     2

a2 = [3,2,1,3]

a2 = 1x4    
     3     2     1     3

a3 = [1,2,3,3]

a3 = 1x4    
     1     2     3     3


a = [a1;a2;a3]&#39;/2

a = 4x3    
    0.5000    1.5000    0.5000
    0.5000    1.0000    1.0000
    1.0000    0.5000    1.5000
    1.0000    1.5000    1.5000


prob_a = zeros(size(a)) + 1/12

prob_a = 4x3    
    0.0833    0.0833    0.0833
    0.0833    0.0833    0.0833
    0.0833    0.0833    0.0833
    0.0833    0.0833    0.0833

[ar_idx_full, ~, ar_idx_of_unique] = unique(a)

ar_idx_full = 3x1    
    0.5000
    1.0000
    1.5000

ar_idx_of_unique = 12x1    
     1
     1
     2
     2
     3
     2
     1
     3
     1
     2

mt_idx_of_unique = reshape(ar_idx_of_unique, size(a))

mt_idx_of_unique = 4x3    
     1     3     1
     1     2     2
     2     1     3
     2     3     3


accumarray(mt_idx_of_unique(:,1), prob_a(:,1))

ans = 2x1    
    0.1667
    0.1667

accumarray(mt_idx_of_unique(:,2), prob_a(:,2))

ans = 3x1    
    0.0833
    0.0833
    0.1667

accumarray(mt_idx_of_unique(:,3), prob_a(:,3))

ans = 3x1    
    0.0833
    0.0833
    0.1667</code></pre>

</div>
</div>
<div id="matlab-miscellaneous-and-basic-numeric-and-array-operations" class="section level3" number="1.1.7">
<h3><span class="header-section-number">1.1.7</span> Matlab Miscellaneous and Basic Numeric and Array Operations</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="divisor-quotient-and-remainder" class="section level4" number="1.1.7.1">
<h4><span class="header-section-number">1.1.7.1</span> Divisor, Quotient and Remainder</h4>
<p>Given an array of integer values, and some divisor, find the quotient
and remainder.</p>
<pre><code>it_divisor = 10;
for bl_int=[0,1]
    if (bl_int == 1)
        ar_integers = int16([1,2,3, 11,12,13, 21,22,23]);
    else
        ar_integers = [1,2,3, 11,12,13, 21,22,23];
    end
    for it_integer=ar_integers
        % Modulus and quotient
        if(isinteger(it_integer))
            it_quotient = idivide(it_integer, it_divisor);
        else
            it_quotient = fix(it_integer/it_divisor);
        end
        it_remainder = rem(it_integer, it_divisor);

        if (it_remainder == 1)
            fl_power = 1.0;
        elseif (it_remainder == 2)
            fl_power = 1.5;
        elseif (it_remainder == 3)
            fl_power = 2.0;
        end

        if (it_quotient == 0)
            fl_base = 2;
        elseif (it_quotient == 1)
            fl_base = exp(1);
        elseif (it_quotient == 2)
            fl_base = 10;
        end

        fl_value = fl_base^fl_power;

        % Print
        st_print = strjoin(...
            [&quot;Divide test:&quot;, ...
            [&#39;bl_int=&#39; num2str(bl_int)], ...
            [&#39;it_integer=&#39; num2str(it_integer)], ...
            [&#39;it_remainder=&#39; num2str(it_remainder)], ...
            [&#39;it_quotient=&#39; num2str(it_quotient)], ...
            [&#39;fl_value=&#39; num2str(fl_value)], ...
            ], &quot;;&quot;);
        disp(st_print);

    end
end

Divide test:;bl_int=0;it_integer=1;it_remainder=1;it_quotient=0;fl_value=2
Divide test:;bl_int=0;it_integer=2;it_remainder=2;it_quotient=0;fl_value=2.8284
Divide test:;bl_int=0;it_integer=3;it_remainder=3;it_quotient=0;fl_value=4
Divide test:;bl_int=0;it_integer=11;it_remainder=1;it_quotient=1;fl_value=2.7183
Divide test:;bl_int=0;it_integer=12;it_remainder=2;it_quotient=1;fl_value=4.4817
Divide test:;bl_int=0;it_integer=13;it_remainder=3;it_quotient=1;fl_value=7.3891
Divide test:;bl_int=0;it_integer=21;it_remainder=1;it_quotient=2;fl_value=10
Divide test:;bl_int=0;it_integer=22;it_remainder=2;it_quotient=2;fl_value=31.6228
Divide test:;bl_int=0;it_integer=23;it_remainder=3;it_quotient=2;fl_value=100
Divide test:;bl_int=1;it_integer=1;it_remainder=1;it_quotient=0;fl_value=2
Divide test:;bl_int=1;it_integer=2;it_remainder=2;it_quotient=0;fl_value=2.8284
Divide test:;bl_int=1;it_integer=3;it_remainder=3;it_quotient=0;fl_value=4
Divide test:;bl_int=1;it_integer=11;it_remainder=1;it_quotient=1;fl_value=2.7183
Divide test:;bl_int=1;it_integer=12;it_remainder=2;it_quotient=1;fl_value=4.4817
Divide test:;bl_int=1;it_integer=13;it_remainder=3;it_quotient=1;fl_value=7.3891
Divide test:;bl_int=1;it_integer=21;it_remainder=1;it_quotient=2;fl_value=10
Divide test:;bl_int=1;it_integer=22;it_remainder=2;it_quotient=2;fl_value=31.6228
Divide test:;bl_int=1;it_integer=23;it_remainder=3;it_quotient=2;fl_value=100</code></pre>
</div>
<div id="check-if-array-is-all-above-or-below-zero" class="section level4" number="1.1.7.2">
<h4><span class="header-section-number">1.1.7.2</span> Check if Array is All Above or Below Zero</h4>
<p>There is an array that contains possible NaN values, check if all
elements of array are positive, or all elements are negative, ignoring
the NaN values.</p>
<pre><code>for it_arrays=[1,2,3,4,5,6]
    if (it_arrays == 1)
        ar_values = [0.0001, 0.0002, 0.0005, 0.0012, 0.0013, NaN, NaN, NaN, NaN];
    elseif (it_arrays == 2)
        ar_values = [NaN, -0.0002, -0.0005, -0.0012, -0.0013, NaN, NaN, NaN, NaN];
    elseif (it_arrays == 3)
        ar_values = [0.0001, 0.0002, 0.0005, 0.0012, 0.0013];
    elseif (it_arrays == 4)
        ar_values = [-0.0002, -0.0005, -0.0012, -0.0013];
    elseif (it_arrays == 5)
        ar_values = [-0.0002, 0.0005, -0.0012, -0.0013];
    elseif (it_arrays == 6)
        ar_values = [-0.0002, 0.0005, -0.0012, NaN, -0.0013];
    end
    bl_all_pos = min(ar_values(~isnan(ar_values))&gt;=0);
    bl_all_neg = min(ar_values(~isnan(ar_values))&lt;=0);
    st_print = [&#39;str=&#39; num2str(it_arrays) ...
        &#39; has bl_all_pos=&#39; num2str(bl_all_pos) &#39; and bl_all_neg=&#39; num2str(bl_all_neg)];
    disp(st_print);
end

str=1 has bl_all_pos=1 and bl_all_neg=0
str=2 has bl_all_pos=0 and bl_all_neg=1
str=3 has bl_all_pos=1 and bl_all_neg=0
str=4 has bl_all_pos=0 and bl_all_neg=1
str=5 has bl_all_pos=0 and bl_all_neg=0
str=6 has bl_all_pos=0 and bl_all_neg=0</code></pre>
</div>
<div id="check-parameter-types" class="section level4" number="1.1.7.3">
<h4><span class="header-section-number">1.1.7.3</span> Check Parameter Types</h4>
<p>There parameter input can either be a cell array or an integer,
conditional processing based on parameter input type. To distinguish
between an array or container map, for example, can use
<a href="https://www.mathworks.com/help/matlab/ref/isnumeric.html">isnumeric</a> or
<a href="https://www.mathworks.com/help/matlab/ref/isfloat.html">isfloat</a>.</p>
<pre><code>% Float and Cell
curEstiParamA = 1;
curEstiParamB = {146, &#39;R3&#39;};
curEstiParamC = rand([1,5]);
curEstiParamD = [1,2,3,4.5];
curEstiParamE = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map(&#39;share_unbanked_j&#39;) = 12;
param_map(&#39;equi_r_j&#39;) = 2;
% test if is float
st_test = strjoin(...
    [&quot;&quot;, ...
    [&#39;isfloat(curEstiParamA)=&#39; num2str(isfloat(curEstiParamA))], ...
    [&#39;isfloat(curEstiParamB)=&#39; num2str(isfloat(curEstiParamB))], ...
    [&#39;isfloat(curEstiParamC)=&#39; num2str(isfloat(curEstiParamC))], ...
    [&#39;isfloat(curEstiParamD)=&#39; num2str(isfloat(curEstiParamD))], ...
    [&#39;isfloat(curEstiParamE)=&#39; num2str(isfloat(curEstiParamE))], ...
    ], &quot;;&quot;);
disp(st_test);

;isfloat(curEstiParamA)=1;isfloat(curEstiParamB)=0;isfloat(curEstiParamC)=1;isfloat(curEstiParamD)=1;isfloat(curEstiParamE)=0

% test if is cell
st_test = strjoin(...
    [&quot;&quot;, ...
    [&#39;iscell(curEstiParamA)=&#39; num2str(iscell(curEstiParamA))], ...
    [&#39;iscell(curEstiParamB)=&#39; num2str(iscell(curEstiParamB))], ...
    [&#39;iscell(curEstiParamC)=&#39; num2str(iscell(curEstiParamC))], ...
    [&#39;iscell(curEstiParamD)=&#39; num2str(iscell(curEstiParamD))], ...
    [&#39;iscell(curEstiParamE)=&#39; num2str(iscell(curEstiParamE))], ...
    ], &quot;;&quot;);
disp(st_test);

;iscell(curEstiParamA)=0;iscell(curEstiParamB)=1;iscell(curEstiParamC)=0;iscell(curEstiParamD)=0;iscell(curEstiParamE)=0

% test if is numeric
st_test = strjoin(...
    [&quot;&quot;, ...
    [&#39;isnumeric(curEstiParamA)=&#39; num2str(isfloat(curEstiParamA))], ...
    [&#39;isnumeric(curEstiParamB)=&#39; num2str(isfloat(curEstiParamB))], ...
    [&#39;isnumeric(curEstiParamC)=&#39; num2str(isfloat(curEstiParamC))], ...
    [&#39;isnumeric(curEstiParamD)=&#39; num2str(isfloat(curEstiParamD))], ...
    [&#39;isnumeric(curEstiParamE)=&#39; num2str(isfloat(curEstiParamE))], ...
    ], &quot;;&quot;);
disp(st_test);

;isnumeric(curEstiParamA)=1;isnumeric(curEstiParamB)=0;isnumeric(curEstiParamC)=1;isnumeric(curEstiParamD)=1;isnumeric(curEstiParamE)=0</code></pre>
</div>
<div id="check-if-a-value-is-an-array-of-single-scalar-boolean" class="section level4" number="1.1.7.4">
<h4><span class="header-section-number">1.1.7.4</span> Check if a value is an array of single scalar boolean</h4>
<p>A function could take an array, if the array parameter input is boolean
and false, then generate the array needed by the function in a different
way. All that is needed is a NaN checker, works for scalar or array of
NaN.</p>
<pre><code>rng(123);
it_len = 3;
for it_case=[1,2,3]
    
    if (it_case == 1)        
        ob_val = rand(1,it_len);
    elseif (it_case == 2)
        % Single NaN
        ob_val = NaN;
    elseif (it_case == 3)
        % Single NaN
        ob_val = NaN(1,it_len);
    end
    
    if (~isnan(ob_val))
        % Input is the output vector since input is not NaN
        ob_val_out = ob_val;
    else
        % Generates random output vector since input is not provided
        ob_val_out = rand(1, it_len);
    end

    st_test = strjoin(...
        [&quot;&quot;, ...
        [&#39;ob_val=&#39; num2str(ob_val)], ...
        [&#39;ob_val_out=&#39; num2str(ob_val_out)], ...
        ], &quot;;&quot;);
    disp(st_test);    
end

;ob_val=0.69647     0.28614     0.22685;ob_val_out=0.69647     0.28614     0.22685
;ob_val=NaN;ob_val_out=0.55131     0.71947     0.42311
;ob_val=NaN  NaN  NaN;ob_val_out=0.98076     0.68483     0.48093</code></pre>
</div>
<div id="compare-array-values-that-are-approximately-similar" class="section level4" number="1.1.7.5">
<h4><span class="header-section-number">1.1.7.5</span> Compare Array Values That are Approximately Similar</h4>
<p><a href="https://stackoverflow.com/a/33024979/8280804">What is the best way to compare floats for almost-equality in
Python?</a></p>
<ul>
<li><p><code>rel_tol is a relative tolerance, it is multiplied by the greater of the magnitudes of the two arguments; as the values get larger, so does the allowed difference between them while still considering them equal.</code></p></li>
<li><p><code>abs_tol is an absolute tolerance that is applied as-is in all cases. If the difference is less than either of those tolerances, the values are considered equal.</code></p></li>
</ul>
<!-- -->
<pre><code>rel_tol=1e-09;
abs_tol=0.0;
if_is_close = @(a,b) (abs(a-b) &lt;= max(rel_tol * max(abs(a), abs(b)), abs_tol));
disp([&#39;1 and 1, if_is_close:&#39; num2str(if_is_close(1,1))]);

1 and 1, if_is_close:1

disp([&#39;1e-300 and 1e-301, if_is_close:&#39; num2str(if_is_close(1e-300,1e-301))]);

1e-300 and 1e-301, if_is_close:0

disp([&#39;1+1e-9 and 1+1e-10, if_is_close:&#39; num2str(if_is_close(1+1e-9,1+1e-10))]);

1+1e-9 and 1+1e-10, if_is_close:1</code></pre>
</div>
<div id="imaginary-number-examples" class="section level4" number="1.1.7.6">
<h4><span class="header-section-number">1.1.7.6</span> Imaginary Number Examples</h4>
<pre><code>rng(123);

% Imaginary array
ar_img = rand([1,7]) + 1i*rand([1,7]);

% Regular Array
ar_real = rand([1,10]);

% Combine arrays
ar_full = [ar_real ar_img];
ar_full = ar_full(randperm(length(ar_full)));
disp(ar_full);

  Columns 1 through 6

   0.6344 + 0.0000i   0.1755 + 0.0000i   0.5316 + 0.0000i   0.2861 + 0.4809i   0.7380 + 0.0000i   0.1825 + 0.0000i

  Columns 7 through 12

   0.6965 + 0.6848i   0.2269 + 0.3921i   0.7245 + 0.0000i   0.8494 + 0.0000i   0.6110 + 0.0000i   0.4231 + 0.4386i

  Columns 13 through 17

   0.9808 + 0.0597i   0.5318 + 0.0000i   0.3980 + 0.0000i   0.5513 + 0.3432i   0.7195 + 0.7290i


% real index
disp(~imag(ar_full));

   1   1   1   0   1   1   0   0   1   1   1   0   0   1   1   0   0


% Get Real and not real Components
disp(ar_full(imag(ar_full) == 0));

    0.6344    0.1755    0.5316    0.7380    0.1825    0.7245    0.8494    0.6110    0.5318    0.3980

disp(ar_full(imag(ar_full) ~= 0));

  Columns 1 through 6

   0.2861 + 0.4809i   0.6965 + 0.6848i   0.2269 + 0.3921i   0.4231 + 0.4386i   0.9808 + 0.0597i   0.5513 + 0.3432i

  Column 7

   0.7195 + 0.7290i</code></pre>

</div>
</div>
</div>
<div id="nd-dimensional-arrays" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> ND Dimensional Arrays</h2>

<div id="joint-arrays-all-combinations-and-by-random-subset" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Joint Arrays All Combinations and by Random Subset</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="given-several-arrays-general-all-possible-combinations" class="section level4" number="1.2.1.1">
<h4><span class="header-section-number">1.2.1.1</span> Given Several Arrays, General all Possible Combinations</h4>
<p>There are several parameters, might want to simulate at all possible
combinations. In the example below, there are four parmeters, generate a
table with all possible combinations of the four parameters.</p>
<pre><code>%% A. Quadc linh refh and refsd parameter grids
[it_p1, it_p2, it_p3] = deal(4, 3, 3);
ar_p1 = linspace(-0.09, -0.02, it_p1);
ar_p2 =  linspace( 0.020, 0.100, it_p2);
ar_p3 =  linspace(-0.100, -0.020, it_p3);
ar_p4 =  [0.05];

%% B. Mesh Parameters together
% ndgrid mesh together
[mn_p1, ~] = ndgrid(ar_p1, ar_p2, ar_p3, ar_p4);
% combine
[ar_p1_idx, ar_p2_idx, ar_p3_idx, ar_p4_idx] = ind2sub(size(mn_p1), find(mn_p1));
% Index and values
ar_p1_flat = ar_p1(ar_p1_idx)&#39;;
ar_p2_flat = ar_p2(ar_p2_idx)&#39;;
ar_p3_flat = ar_p3(ar_p3_idx)&#39;;
ar_p4_flat = ar_p4(ar_p4_idx)&#39;;
mt_paramsmesh_long = [ar_p1_idx(:), ar_p1_flat(:), ...
    ar_p2_idx(:), ar_p2_flat(:), ...
    ar_p3_idx(:), ar_p3_flat(:), ...
    ar_p4_idx(:), ar_p4_flat(:)];
% Sort by a and z
mt_paramsmesh_long = sortrows(mt_paramsmesh_long, [1,3, 5]);

% C. Create Table
tb_paramsmesh_long = array2table(mt_paramsmesh_long);
cl_col_names_a = {&#39;quadc_idx&#39;, &#39;quadc_val&#39;, ...
    &#39;linh_idx&#39;, &#39;linh_val&#39;, ...
    &#39;refh_idx&#39;, &#39;rehfh_val&#39;, ...
    &#39;refsd_idx&#39;, &#39;rehfsd_val&#39;};
tb_paramsmesh_long.Properties.VariableNames = cl_col_names_a;
% D. Display Table
disp(tb_paramsmesh_long);

    quadc_idx    quadc_val    linh_idx    linh_val    refh_idx    rehfh_val    refsd_idx    rehfsd_val
    _________    _________    ________    ________    ________    _________    _________    __________

        1            -0.09       1          0.02         1           -0.1          1           0.05   
        1            -0.09       1          0.02         2          -0.06          1           0.05   
        1            -0.09       1          0.02         3          -0.02          1           0.05   
        1            -0.09       2          0.06         1           -0.1          1           0.05   
        1            -0.09       2          0.06         2          -0.06          1           0.05   
        1            -0.09       2          0.06         3          -0.02          1           0.05   
        1            -0.09       3           0.1         1           -0.1          1           0.05   
        1            -0.09       3           0.1         2          -0.06          1           0.05   
        1            -0.09       3           0.1         3          -0.02          1           0.05   
        2        -0.066667       1          0.02         1           -0.1          1           0.05   
        2        -0.066667       1          0.02         2          -0.06          1           0.05   
        2        -0.066667       1          0.02         3          -0.02          1           0.05   
        2        -0.066667       2          0.06         1           -0.1          1           0.05   
        2        -0.066667       2          0.06         2          -0.06          1           0.05   
        2        -0.066667       2          0.06         3          -0.02          1           0.05   
        2        -0.066667       3           0.1         1           -0.1          1           0.05   
        2        -0.066667       3           0.1         2          -0.06          1           0.05   
        2        -0.066667       3           0.1         3          -0.02          1           0.05   
        3        -0.043333       1          0.02         1           -0.1          1           0.05   
        3        -0.043333       1          0.02         2          -0.06          1           0.05   
        3        -0.043333       1          0.02         3          -0.02          1           0.05   
        3        -0.043333       2          0.06         1           -0.1          1           0.05   
        3        -0.043333       2          0.06         2          -0.06          1           0.05   
        3        -0.043333       2          0.06         3          -0.02          1           0.05   
        3        -0.043333       3           0.1         1           -0.1          1           0.05   
        3        -0.043333       3           0.1         2          -0.06          1           0.05   
        3        -0.043333       3           0.1         3          -0.02          1           0.05   
        4            -0.02       1          0.02         1           -0.1          1           0.05   
        4            -0.02       1          0.02         2          -0.06          1           0.05   
        4            -0.02       1          0.02         3          -0.02          1           0.05   
        4            -0.02       2          0.06         1           -0.1          1           0.05   
        4            -0.02       2          0.06         2          -0.06          1           0.05   
        4            -0.02       2          0.06         3          -0.02          1           0.05   
        4            -0.02       3           0.1         1           -0.1          1           0.05   
        4            -0.02       3           0.1         2          -0.06          1           0.05   
        4            -0.02       3           0.1         3          -0.02          1           0.05   </code></pre>
</div>
<div id="matlab-draw-random-with-and-without-replacement" class="section level4" number="1.2.1.2">
<h4><span class="header-section-number">1.2.1.2</span> Matlab Draw Random with and without Replacement</h4>
<pre><code>%Generate a matrix named foo, with limited numbers
rng(1234);
foo = unique((round((randn(5,1)+1)*100)));
disp(foo);

     5
    78
   154
   219
   232


% draw 10 random samples without replacement
index = randsample(1:length(foo), 4);
bar_rand_noreplace = foo(index,:);

% draw 1000 random samples with replacement
index = randsample(1:length(foo), 4, true);
bar_rand_replace = foo(index,:);

% Display
disp(table(bar_rand_noreplace, bar_rand_replace));

    bar_rand_noreplace    bar_rand_replace
    __________________    ________________

             5                   78       
            78                  154       
           154                  219       
           232                  219       </code></pre>
</div>
<div id="matrix-meshgrid-to-loop-permutated-vectors" class="section level4" number="1.2.1.3">
<h4><span class="header-section-number">1.2.1.3</span> Matrix Meshgrid to Loop Permutated Vectors</h4>
<p>Meshgrid to generate all permutations of arrays.</p>
<pre><code>k = linspace(1,10,10);
kp = linspace(1,10,10);
z = linspace(0,1,10);
 
[kM kpM zM] = meshgrid(k,kp,z);
kMVec = kM(:);
kMpVec = kpM(:);
zMVec = zM(:);
 
outputVec = zeros(size(zMVec));
for a=1:length(zMVec)
     outputVec(a) = kMVec(a)+kMpVec(a)+zMVec(a);
end
 
outputTens = reshape(outputVec,size(kM));
disp(outputTens);

(:,:,1) =

     2     3     4     5     6     7     8     9    10    11
     3     4     5     6     7     8     9    10    11    12
     4     5     6     7     8     9    10    11    12    13
     5     6     7     8     9    10    11    12    13    14
     6     7     8     9    10    11    12    13    14    15
     7     8     9    10    11    12    13    14    15    16
     8     9    10    11    12    13    14    15    16    17
     9    10    11    12    13    14    15    16    17    18
    10    11    12    13    14    15    16    17    18    19
    11    12    13    14    15    16    17    18    19    20


(:,:,2) =

    2.1111    3.1111    4.1111    5.1111    6.1111    7.1111    8.1111    9.1111   10.1111   11.1111
    3.1111    4.1111    5.1111    6.1111    7.1111    8.1111    9.1111   10.1111   11.1111   12.1111
    4.1111    5.1111    6.1111    7.1111    8.1111    9.1111   10.1111   11.1111   12.1111   13.1111
    5.1111    6.1111    7.1111    8.1111    9.1111   10.1111   11.1111   12.1111   13.1111   14.1111
    6.1111    7.1111    8.1111    9.1111   10.1111   11.1111   12.1111   13.1111   14.1111   15.1111
    7.1111    8.1111    9.1111   10.1111   11.1111   12.1111   13.1111   14.1111   15.1111   16.1111
    8.1111    9.1111   10.1111   11.1111   12.1111   13.1111   14.1111   15.1111   16.1111   17.1111
    9.1111   10.1111   11.1111   12.1111   13.1111   14.1111   15.1111   16.1111   17.1111   18.1111
   10.1111   11.1111   12.1111   13.1111   14.1111   15.1111   16.1111   17.1111   18.1111   19.1111
   11.1111   12.1111   13.1111   14.1111   15.1111   16.1111   17.1111   18.1111   19.1111   20.1111


(:,:,3) =

    2.2222    3.2222    4.2222    5.2222    6.2222    7.2222    8.2222    9.2222   10.2222   11.2222
    3.2222    4.2222    5.2222    6.2222    7.2222    8.2222    9.2222   10.2222   11.2222   12.2222
    4.2222    5.2222    6.2222    7.2222    8.2222    9.2222   10.2222   11.2222   12.2222   13.2222
    5.2222    6.2222    7.2222    8.2222    9.2222   10.2222   11.2222   12.2222   13.2222   14.2222
    6.2222    7.2222    8.2222    9.2222   10.2222   11.2222   12.2222   13.2222   14.2222   15.2222
    7.2222    8.2222    9.2222   10.2222   11.2222   12.2222   13.2222   14.2222   15.2222   16.2222
    8.2222    9.2222   10.2222   11.2222   12.2222   13.2222   14.2222   15.2222   16.2222   17.2222
    9.2222   10.2222   11.2222   12.2222   13.2222   14.2222   15.2222   16.2222   17.2222   18.2222
   10.2222   11.2222   12.2222   13.2222   14.2222   15.2222   16.2222   17.2222   18.2222   19.2222
   11.2222   12.2222   13.2222   14.2222   15.2222   16.2222   17.2222   18.2222   19.2222   20.2222


(:,:,4) =

    2.3333    3.3333    4.3333    5.3333    6.3333    7.3333    8.3333    9.3333   10.3333   11.3333
    3.3333    4.3333    5.3333    6.3333    7.3333    8.3333    9.3333   10.3333   11.3333   12.3333
    4.3333    5.3333    6.3333    7.3333    8.3333    9.3333   10.3333   11.3333   12.3333   13.3333
    5.3333    6.3333    7.3333    8.3333    9.3333   10.3333   11.3333   12.3333   13.3333   14.3333
    6.3333    7.3333    8.3333    9.3333   10.3333   11.3333   12.3333   13.3333   14.3333   15.3333
    7.3333    8.3333    9.3333   10.3333   11.3333   12.3333   13.3333   14.3333   15.3333   16.3333
    8.3333    9.3333   10.3333   11.3333   12.3333   13.3333   14.3333   15.3333   16.3333   17.3333
    9.3333   10.3333   11.3333   12.3333   13.3333   14.3333   15.3333   16.3333   17.3333   18.3333
   10.3333   11.3333   12.3333   13.3333   14.3333   15.3333   16.3333   17.3333   18.3333   19.3333
   11.3333   12.3333   13.3333   14.3333   15.3333   16.3333   17.3333   18.3333   19.3333   20.3333


(:,:,5) =

    2.4444    3.4444    4.4444    5.4444    6.4444    7.4444    8.4444    9.4444   10.4444   11.4444
    3.4444    4.4444    5.4444    6.4444    7.4444    8.4444    9.4444   10.4444   11.4444   12.4444
    4.4444    5.4444    6.4444    7.4444    8.4444    9.4444   10.4444   11.4444   12.4444   13.4444
    5.4444    6.4444    7.4444    8.4444    9.4444   10.4444   11.4444   12.4444   13.4444   14.4444
    6.4444    7.4444    8.4444    9.4444   10.4444   11.4444   12.4444   13.4444   14.4444   15.4444
    7.4444    8.4444    9.4444   10.4444   11.4444   12.4444   13.4444   14.4444   15.4444   16.4444
    8.4444    9.4444   10.4444   11.4444   12.4444   13.4444   14.4444   15.4444   16.4444   17.4444
    9.4444   10.4444   11.4444   12.4444   13.4444   14.4444   15.4444   16.4444   17.4444   18.4444
   10.4444   11.4444   12.4444   13.4444   14.4444   15.4444   16.4444   17.4444   18.4444   19.4444
   11.4444   12.4444   13.4444   14.4444   15.4444   16.4444   17.4444   18.4444   19.4444   20.4444


(:,:,6) =

    2.5556    3.5556    4.5556    5.5556    6.5556    7.5556    8.5556    9.5556   10.5556   11.5556
    3.5556    4.5556    5.5556    6.5556    7.5556    8.5556    9.5556   10.5556   11.5556   12.5556
    4.5556    5.5556    6.5556    7.5556    8.5556    9.5556   10.5556   11.5556   12.5556   13.5556
    5.5556    6.5556    7.5556    8.5556    9.5556   10.5556   11.5556   12.5556   13.5556   14.5556
    6.5556    7.5556    8.5556    9.5556   10.5556   11.5556   12.5556   13.5556   14.5556   15.5556
    7.5556    8.5556    9.5556   10.5556   11.5556   12.5556   13.5556   14.5556   15.5556   16.5556
    8.5556    9.5556   10.5556   11.5556   12.5556   13.5556   14.5556   15.5556   16.5556   17.5556
    9.5556   10.5556   11.5556   12.5556   13.5556   14.5556   15.5556   16.5556   17.5556   18.5556
   10.5556   11.5556   12.5556   13.5556   14.5556   15.5556   16.5556   17.5556   18.5556   19.5556
   11.5556   12.5556   13.5556   14.5556   15.5556   16.5556   17.5556   18.5556   19.5556   20.5556


(:,:,7) =

    2.6667    3.6667    4.6667    5.6667    6.6667    7.6667    8.6667    9.6667   10.6667   11.6667
    3.6667    4.6667    5.6667    6.6667    7.6667    8.6667    9.6667   10.6667   11.6667   12.6667
    4.6667    5.6667    6.6667    7.6667    8.6667    9.6667   10.6667   11.6667   12.6667   13.6667
    5.6667    6.6667    7.6667    8.6667    9.6667   10.6667   11.6667   12.6667   13.6667   14.6667
    6.6667    7.6667    8.6667    9.6667   10.6667   11.6667   12.6667   13.6667   14.6667   15.6667
    7.6667    8.6667    9.6667   10.6667   11.6667   12.6667   13.6667   14.6667   15.6667   16.6667
    8.6667    9.6667   10.6667   11.6667   12.6667   13.6667   14.6667   15.6667   16.6667   17.6667
    9.6667   10.6667   11.6667   12.6667   13.6667   14.6667   15.6667   16.6667   17.6667   18.6667
   10.6667   11.6667   12.6667   13.6667   14.6667   15.6667   16.6667   17.6667   18.6667   19.6667
   11.6667   12.6667   13.6667   14.6667   15.6667   16.6667   17.6667   18.6667   19.6667   20.6667


(:,:,8) =

    2.7778    3.7778    4.7778    5.7778    6.7778    7.7778    8.7778    9.7778   10.7778   11.7778
    3.7778    4.7778    5.7778    6.7778    7.7778    8.7778    9.7778   10.7778   11.7778   12.7778
    4.7778    5.7778    6.7778    7.7778    8.7778    9.7778   10.7778   11.7778   12.7778   13.7778
    5.7778    6.7778    7.7778    8.7778    9.7778   10.7778   11.7778   12.7778   13.7778   14.7778
    6.7778    7.7778    8.7778    9.7778   10.7778   11.7778   12.7778   13.7778   14.7778   15.7778
    7.7778    8.7778    9.7778   10.7778   11.7778   12.7778   13.7778   14.7778   15.7778   16.7778
    8.7778    9.7778   10.7778   11.7778   12.7778   13.7778   14.7778   15.7778   16.7778   17.7778
    9.7778   10.7778   11.7778   12.7778   13.7778   14.7778   15.7778   16.7778   17.7778   18.7778
   10.7778   11.7778   12.7778   13.7778   14.7778   15.7778   16.7778   17.7778   18.7778   19.7778
   11.7778   12.7778   13.7778   14.7778   15.7778   16.7778   17.7778   18.7778   19.7778   20.7778


(:,:,9) =

    2.8889    3.8889    4.8889    5.8889    6.8889    7.8889    8.8889    9.8889   10.8889   11.8889
    3.8889    4.8889    5.8889    6.8889    7.8889    8.8889    9.8889   10.8889   11.8889   12.8889
    4.8889    5.8889    6.8889    7.8889    8.8889    9.8889   10.8889   11.8889   12.8889   13.8889
    5.8889    6.8889    7.8889    8.8889    9.8889   10.8889   11.8889   12.8889   13.8889   14.8889
    6.8889    7.8889    8.8889    9.8889   10.8889   11.8889   12.8889   13.8889   14.8889   15.8889
    7.8889    8.8889    9.8889   10.8889   11.8889   12.8889   13.8889   14.8889   15.8889   16.8889
    8.8889    9.8889   10.8889   11.8889   12.8889   13.8889   14.8889   15.8889   16.8889   17.8889
    9.8889   10.8889   11.8889   12.8889   13.8889   14.8889   15.8889   16.8889   17.8889   18.8889
   10.8889   11.8889   12.8889   13.8889   14.8889   15.8889   16.8889   17.8889   18.8889   19.8889
   11.8889   12.8889   13.8889   14.8889   15.8889   16.8889   17.8889   18.8889   19.8889   20.8889


(:,:,10) =

     3     4     5     6     7     8     9    10    11    12
     4     5     6     7     8     9    10    11    12    13
     5     6     7     8     9    10    11    12    13    14
     6     7     8     9    10    11    12    13    14    15
     7     8     9    10    11    12    13    14    15    16
     8     9    10    11    12    13    14    15    16    17
     9    10    11    12    13    14    15    16    17    18
    10    11    12    13    14    15    16    17    18    19
    11    12    13    14    15    16    17    18    19    20
    12    13    14    15    16    17    18    19    20    21</code></pre>
</div>
<div id="given-integer-arrays-all-possible-combinations" class="section level4" number="1.2.1.4">
<h4><span class="header-section-number">1.2.1.4</span> Given Integer Arrays, All Possible Combinations</h4>
<p>given any sizes arrays, N of them, create all possible combinations</p>
<pre><code>ar_it_a = 1:3;
ar_it_b = 1:2;
ar_it_c = 2:4;
ar_it_d = -1:-1:-2;
ar_it_e = 0.1;

cl_ar_all = {ar_it_a, ar_it_b, ar_it_c, ar_it_d, ar_it_e};
cl_mt_all = cl_ar_all;
[cl_mt_all{:}] = ndgrid(cl_ar_all{:});
mt_it_allcombo = cell2mat(cellfun(@(m) m(:), cl_mt_all, &#39;uni&#39;, 0));

disp(mt_it_allcombo)

    1.0000    1.0000    2.0000   -1.0000    0.1000
    2.0000    1.0000    2.0000   -1.0000    0.1000
    3.0000    1.0000    2.0000   -1.0000    0.1000
    1.0000    2.0000    2.0000   -1.0000    0.1000
    2.0000    2.0000    2.0000   -1.0000    0.1000
    3.0000    2.0000    2.0000   -1.0000    0.1000
    1.0000    1.0000    3.0000   -1.0000    0.1000
    2.0000    1.0000    3.0000   -1.0000    0.1000
    3.0000    1.0000    3.0000   -1.0000    0.1000
    1.0000    2.0000    3.0000   -1.0000    0.1000
    2.0000    2.0000    3.0000   -1.0000    0.1000
    3.0000    2.0000    3.0000   -1.0000    0.1000
    1.0000    1.0000    4.0000   -1.0000    0.1000
    2.0000    1.0000    4.0000   -1.0000    0.1000
    3.0000    1.0000    4.0000   -1.0000    0.1000
    1.0000    2.0000    4.0000   -1.0000    0.1000
    2.0000    2.0000    4.0000   -1.0000    0.1000
    3.0000    2.0000    4.0000   -1.0000    0.1000
    1.0000    1.0000    2.0000   -2.0000    0.1000
    2.0000    1.0000    2.0000   -2.0000    0.1000
    3.0000    1.0000    2.0000   -2.0000    0.1000
    1.0000    2.0000    2.0000   -2.0000    0.1000
    2.0000    2.0000    2.0000   -2.0000    0.1000
    3.0000    2.0000    2.0000   -2.0000    0.1000
    1.0000    1.0000    3.0000   -2.0000    0.1000
    2.0000    1.0000    3.0000   -2.0000    0.1000
    3.0000    1.0000    3.0000   -2.0000    0.1000
    1.0000    2.0000    3.0000   -2.0000    0.1000
    2.0000    2.0000    3.0000   -2.0000    0.1000
    3.0000    2.0000    3.0000   -2.0000    0.1000
    1.0000    1.0000    4.0000   -2.0000    0.1000
    2.0000    1.0000    4.0000   -2.0000    0.1000
    3.0000    1.0000    4.0000   -2.0000    0.1000
    1.0000    2.0000    4.0000   -2.0000    0.1000
    2.0000    2.0000    4.0000   -2.0000    0.1000
    3.0000    2.0000    4.0000   -2.0000    0.1000</code></pre>

</div>
</div>
<div id="d-4d-nd-arrays-reshape-and-rearrange-dimensions" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> 3D, 4D, ND Arrays Reshape and Rearrange Dimensions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="d-array-to-cell-array-of-matrix-split-by-last-dimension" class="section level4" number="1.2.2.1">
<h4><span class="header-section-number">1.2.2.1</span> 3D Array to Cell Array of Matrix Split by Last Dimension</h4>
<p>Convert Multi-dimensional arrays to a cell array consistent of two
dimensional arrays. In this example, we split by the 3rd dimension, so
the number of output matrixes is equal to the length of the 3rd
dimension.</p>
<p>First create a three dimensional array, two matrixes that are 4 by 3
each:</p>
<pre><code>% Create a 3D Array
rng(123);
mn_rand = rand(4,3,2);
disp(mn_rand);

(:,:,1) =

    0.6965    0.7195    0.4809
    0.2861    0.4231    0.3921
    0.2269    0.9808    0.3432
    0.5513    0.6848    0.7290


(:,:,2) =

    0.4386    0.1825    0.6344
    0.0597    0.1755    0.8494
    0.3980    0.5316    0.7245
    0.7380    0.5318    0.6110</code></pre>
<p>Now convert the 3 dimensional array to a 2 by 1 cell array that contains
matrixes in each cell:</p>
<pre><code>% Squeece 3D array to a Cell array of matrixes
cl_mn_rand = squeeze(num2cell(mn_rand, [1,2]));
celldisp(cl_mn_rand);


cl_mn_rand{1} =
 
    0.6965    0.7195    0.4809
    0.2861    0.4231    0.3921
    0.2269    0.9808    0.3432
    0.5513    0.6848    0.7290



cl_mn_rand{2} =
 
    0.4386    0.1825    0.6344
    0.0597    0.1755    0.8494
    0.3980    0.5316    0.7245
    0.7380    0.5318    0.6110</code></pre>
</div>
<div id="d-array-to-cell-array-of-matrix-split-by-last-two-dimensions" class="section level4" number="1.2.2.2">
<h4><span class="header-section-number">1.2.2.2</span> 4D Array to Cell Array of Matrix Split by Last Two Dimensions</h4>
<p>Convert 4D Multi-dimensional arrays to a cell array consistent of two
dimensional arrays. In this example, the first two dimensions determine
the resulting matrix size, the the 3rd and the 4th dimensions are
categorical.</p>
<p>First create a four dimensional array, four matrixes stored each matrix
is 2 by 2:</p>
<pre><code>% Create a 3D Array
rng(123);
mn_rand = rand(2,2,2,2);
disp(mn_rand);

(:,:,1,1) =

    0.6965    0.2269
    0.2861    0.5513


(:,:,2,1) =

    0.7195    0.9808
    0.4231    0.6848


(:,:,1,2) =

    0.4809    0.3432
    0.3921    0.7290


(:,:,2,2) =

    0.4386    0.3980
    0.0597    0.7380</code></pre>
<p>Now convert the 4 dimensional array to a 2 by 2 cell array that contains
matrixes in each cell:</p>
<pre><code>% Squeece 3D array to a Cell array of matrixes
cl_mn_rand = squeeze(num2cell(mn_rand, [1,2]));
celldisp(cl_mn_rand);


cl_mn_rand{1,1} =
 
    0.6965    0.2269
    0.2861    0.5513



cl_mn_rand{2,1} =
 
    0.7195    0.9808
    0.4231    0.6848



cl_mn_rand{1,2} =
 
    0.4809    0.3432
    0.3921    0.7290



cl_mn_rand{2,2} =
 
    0.4386    0.3980
    0.0597    0.7380</code></pre>
</div>
<div id="d-array-to-cell-array-of-matrix-split-by-first-and-fourth-dimensions-rearrange-dimensions" class="section level4" number="1.2.2.3">
<h4><span class="header-section-number">1.2.2.3</span> 4D Array to Cell Array of Matrix Split by First and Fourth Dimensions Rearrange Dimensions</h4>
<p>Suppose we store policy and value function given four state variables.
The first one is age, the second one is asset, the third one is shock,
and the fourth one is the number of kids. We start out with a four
dimensional matrix. The objective is to create a two dimensional cell
array as output where indexed by the 1st and 4th dimension of the
underlying numeric array, and the elements of the 2D cell array are
matrixes.</p>
<p>This is achieved by the
<a href="https://www.mathworks.com/help/matlab/ref/permute.html">permute</a>
function. We first rearrange the matrix, so that the 2nd and 3rd
dimensions become the 1st and 2nd, then we use the technique used above
to squeeze out the first two dimensions as matrixes with the last two as
categories.</p>
<p>First, generate the 2 by 2 by 2 by 2, (Age, A, Z, Kids Count), matrix:</p>
<pre><code>% Create a 3D Array
rng(123);
% (Age, A, Z, Kids Count)
mn_rand = rand(2,2,2,2);</code></pre>
<p>Second, loop out the (A,Z) matrix by Age and Kids Count, this shows us
what we want to achieve. Note that each row is Age, each column is A,
each submatrix is z, and each super-matrix is kid-count. So from
slicing, each column printed out are different value of A, the two
submatrixes printed out are for each z. For the output structure where
we want a (A,Z) matrix, the columns need to become rows, and the
submatrix need to become columns.</p>
<pre><code>% Show Matrix by Age and Kids
for it_age = 1:size(mn_rand,1)
    for it_kids = 1:size(mn_rand,4)
        disp(strcat([&#39;it_age:&#39; num2str(it_age) &#39;, it_kids:&#39; num2str(it_kids)]))
        disp(mn_rand(it_age,:,:,it_kids));
    end
end

it_age:1, it_kids:1
(:,:,1) =

    0.6965    0.2269


(:,:,2) =

    0.7195    0.9808
it_age:1, it_kids:2
(:,:,1) =

    0.4809    0.3432


(:,:,2) =

    0.4386    0.3980
it_age:2, it_kids:1
(:,:,1) =

    0.2861    0.5513


(:,:,2) =

    0.4231    0.6848
it_age:2, it_kids:2
(:,:,1) =

    0.3921    0.7290


(:,:,2) =

    0.0597    0.7380</code></pre>
<p>Third, we permutate the matrix and squeeze to arrive at the 2 by 2 cell,
note that step two is just to show via loop what we should get:</p>
<pre><code>% Rearrange dimensions
mn_rand_2314 = permute(mn_rand, [2,3,1,4]);
% Squeeze the first two dimensiosn as before
cl_mn_rand = squeeze(num2cell(mn_rand_2314, [1,2]));
% show
celldisp(cl_mn_rand);


cl_mn_rand{1,1} =
 
    0.6965    0.7195
    0.2269    0.9808



cl_mn_rand{2,1} =
 
    0.2861    0.4231
    0.5513    0.6848



cl_mn_rand{1,2} =
 
    0.4809    0.4386
    0.3432    0.3980



cl_mn_rand{2,2} =
 
    0.3921    0.0597
    0.7290    0.7380</code></pre>
</div>
<div id="nd-array-summarize-in-table" class="section level4" number="1.2.2.4">
<h4><span class="header-section-number">1.2.2.4</span> ND Array Summarize in Table</h4>
<p>Given an ND dataframe, summarize the first two dimensions. For each
possible combination of the 3rd and 4th dimension, generate mean, sd,
min and max over the matrix of the first two dimensions. This is similar
to a tabulation function.</p>
<p>First, we generate several array of information:</p>
<pre><code>% Initialize and Squeeze
rng(123);
mn_rand = rand(2,2,2,2);
cln_mt_rand = squeeze(num2cell(mn_rand, [1,2]));
cl_mt_rand = cln_mt_rand(:);
celldisp(cl_mt_rand);


cl_mt_rand{1} =
 
    0.6965    0.2269
    0.2861    0.5513



cl_mt_rand{2} =
 
    0.7195    0.9808
    0.4231    0.6848



cl_mt_rand{3} =
 
    0.4809    0.3432
    0.3921    0.7290



cl_mt_rand{4} =
 
    0.4386    0.3980
    0.0597    0.7380</code></pre>
<p>Second, create two arrays that tracks for each element of cl_mt_rand,
which one of the 3rd and 4th dimensions they correspond to:</p>
<pre><code>ar_dim_3 = [31,32]&#39;;
ar_dim_4 = [41,42]&#39;;
[mt_dim_3, mt_dim_4] = ndgrid(ar_dim_3, ar_dim_4);
ar_dim_3 = mt_dim_3(:);
ar_dim_4 = mt_dim_4(:);</code></pre>
<p>Third, summarize each matrix:</p>
<pre><code>% Over of matrix and summarize
ar_mean = zeros(size(cl_mt_rand));
ar_std = zeros(size(cl_mt_rand));
for it_mt=1:length(cl_mt_rand)
    mt_cur = cl_mt_rand{it_mt};
    ar_mean(it_mt) = mean(mt_cur, &#39;all&#39;);
    ar_std(it_mt) = std(mt_cur, [], &#39;all&#39;);
end</code></pre>
<p>Fourth Construct a Table</p>
<pre><code>% Constructe Table
tb_rowcols_tab = array2table([(1:length(cl_mt_rand))&#39;, ...
    ar_dim_3, ar_dim_4, ar_mean, ar_std]);
tb_rowcols_tab.Properties.VariableNames = ...
    matlab.lang.makeValidName([&quot;i&quot;, &quot;dim3&quot;, &quot;dim4&quot;,  &quot;mean&quot;, &quot;std&quot;]);
disp(tb_rowcols_tab);

    i    dim3    dim4     mean        std  
    _    ____    ____    _______    _______

    1     31      41     0.44019    0.22156
    2     32      41     0.70204     0.2281
    3     31      42     0.48632    0.17157
    4     32      42     0.40857    0.27764</code></pre>
</div>
<div id="nd-array-two-way-summarize-in-table" class="section level4" number="1.2.2.5">
<h4><span class="header-section-number">1.2.2.5</span> ND Array Two-Way Summarize in Table</h4>
<p>Given dataframe as above, but we now want to add to the resulting
summary table additional columns, rather than taking the means of the
entire matrix in the first two dimensions, we only take average with
respect to the rows, the first dimension, the second dimension show up
as coumn statistics names, still multiple stats. The results worked out
here are embedded in the
<a href="https://fanwangecon.github.io/MEconTools/MEconTools/doc/summ/htmlpdfm/fx_summ_nd_array.html">fx_summ_nd_array</a>
function of the <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a>
Package.</p>
<p>First, we generate several array of information:</p>
<pre><code>% dimension names
st_title = &#39;Summarize values over a conditional on z (columns) and kids and marriage (rows)&#39;;
st_dim_1 = &#39;a&#39;;
st_dim_2 = &#39;z&#39;;
st_dim_3 = &#39;kid&#39;;
st_dim_4 = &#39;marriage&#39;;
% 3rd and fourth dimension values
ar_dim_2 = [-3, -1, 1, 3];
ar_dim_3 = [1,2,3];
ar_dim_4 = [0,1];
% Initialize and Squeeze
rng(123);
mn_rand = rand(10,4,3,2);
cln_mt_rand = squeeze(num2cell(mn_rand, [1,2]));
cl_mt_rand = cln_mt_rand(:);</code></pre>
<p>Second, create two arrays that tracks for each element of cl_mt_rand,
which one of the 3rd and 4th dimensions they correspond to:</p>
<pre><code>[mt_dim_3, mt_dim_4] = ndgrid(ar_dim_3&#39;, ar_dim_4&#39;);
ar_dim_3 = mt_dim_3(:);
ar_dim_4 = mt_dim_4(:);</code></pre>
<p>Third, summarize each matrix:</p>
<pre><code>% Over of matrix and summarize
mt_mean = zeros(length(cl_mt_rand), size(mn_rand,2));
mt_std = zeros(length(cl_mt_rand), size(mn_rand,2));
for it_mt=1:length(cl_mt_rand)
    mt_cur = cl_mt_rand{it_mt};
    mt_mean(it_mt,:) = mean(mt_cur, 1);
    mt_std(it_mt,:) = std(mt_cur, [], 1);
end</code></pre>
<p>Fourth Construct a Table</p>
<pre><code>% Constructe Table
tb_rowcols_tab = array2table([(1:length(cl_mt_rand))&#39;, ...
    ar_dim_3, ar_dim_4, mt_mean, mt_std]);
% Column Names
cl_col_names_cate_dims = [string(st_dim_3), string(st_dim_4)];
cl_col_names_mn = strcat(&#39;mean_&#39;, st_dim_2, string(ar_dim_2));
cl_col_names_sd = strcat(&#39;sd_&#39;, st_dim_2, string(ar_dim_2));
tb_rowcols_tab.Properties.VariableNames = ...
    matlab.lang.makeValidName([&quot;group&quot;, cl_col_names_cate_dims, cl_col_names_mn, cl_col_names_sd]);
% disp([&#39;xxx &#39; st_title &#39; xxxxxxxxxxxxxxxxxxxxxxxxxxx&#39;]);
disp(tb_rowcols_tab);

    group    kid    marriage    mean_z_3    mean_z_1    mean_z1    mean_z3    sd_z_3     sd_z_1      sd_z1      sd_z3 
    _____    ___    ________    ________    ________    _______    _______    _______    _______    _______    _______

      1       1        0         0.5442     0.41278     0.53795    0.49542    0.22935    0.22945    0.21653    0.25245
      2       2        0        0.51894     0.52262     0.52544    0.45066    0.26787    0.23615    0.25833    0.31178
      3       3        0        0.48248      0.5238     0.50392    0.46534    0.27009    0.26676    0.26644    0.29449
      4       1        1        0.58343     0.50529     0.54361     0.5006    0.29578    0.30182    0.30952    0.27317
      5       2        1        0.58408     0.45941     0.50466    0.40081    0.25026    0.34704    0.31039    0.28693
      6       3        1        0.51148     0.49531     0.48963    0.47698     0.3271    0.24336    0.34498    0.34004</code></pre>

</div>
</div>
<div id="multidimensional-nd-array-to-2d-matrix-with-wide-to-long" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Multidimensional ND Array to 2D Matrix with Wide to Long</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="d-matrix-wide-to-long" class="section level4" number="1.2.3.1">
<h4><span class="header-section-number">1.2.3.1</span> 2D Matrix Wide to Long</h4>
<p>There is a 2D matrix, the rows and columns are state variables (savings
levels and shocks) for storage and graphing purposes, convert the 2D
matrix where each row is a savings level and each column is a shock
level to a 2D table where the first column records savings state, second
column the level of shocks, and the third column stores the optimal
policy or value at that particular combination of savings level and
shock level.</p>
<p>First, generate a random 2D matrix:</p>
<pre><code>% Create a 3D Array
it_z_n = 3;
it_a_n = 5;
% shock savings and shock array
ar_a = linspace(0.1, 50, it_a_n);
ar_z = linspace(-3, 3, it_z_n);
% function of a and z
mt_f_a_z = ar_a&#39; + exp(ar_z);
% Display
disp(mt_f_a_z);

    0.1498    1.1000   20.1855
   12.6248   13.5750   32.6605
   25.0998   26.0500   45.1355
   37.5748   38.5250   57.6105
   50.0498   51.0000   70.0855</code></pre>
<p>Second, from linear index to row and column index:</p>
<pre><code>% Row and Column index for each matrix value
% Only keep non-NAN values
ar_id_isnan = isnan(mt_f_a_z);
[ar_a_idx, ar_z_idx] = ind2sub(size(mt_f_a_z), find(~ar_id_isnan));
% Display
disp([ar_a_idx, ar_a(ar_a_idx)&#39;, ar_z_idx, ar_z(ar_z_idx)&#39;]);

    1.0000    0.1000    1.0000   -3.0000
    2.0000   12.5750    1.0000   -3.0000
    3.0000   25.0500    1.0000   -3.0000
    4.0000   37.5250    1.0000   -3.0000
    5.0000   50.0000    1.0000   -3.0000
    1.0000    0.1000    2.0000         0
    2.0000   12.5750    2.0000         0
    3.0000   25.0500    2.0000         0
    4.0000   37.5250    2.0000         0
    5.0000   50.0000    2.0000         0
    1.0000    0.1000    3.0000    3.0000
    2.0000   12.5750    3.0000    3.0000
    3.0000   25.0500    3.0000    3.0000
    4.0000   37.5250    3.0000    3.0000
    5.0000   50.0000    3.0000    3.0000</code></pre>
<p>Third, generate a 2d matrix in "table" format:</p>
<pre><code>% Index and values
mt_policy_long = [ar_a_idx, ar_a(ar_a_idx)&#39;, ar_z_idx, ar_z(ar_z_idx)&#39;, mt_f_a_z(~ar_id_isnan)];
% Sort by a and z
mt_policy_long = sortrows(mt_policy_long, [1,3]);</code></pre>
<p>Fourth, generate a Table with Column names:</p>
<pre><code>% Create Table
tb_policy_long = array2table(mt_policy_long);
cl_col_names_a = {&#39;a_idx&#39;, &#39;a_val&#39;, &#39;z_idx&#39;, &#39;z_val&#39;, &#39;pol_at_a_z&#39;};
tb_policy_long.Properties.VariableNames = cl_col_names_a;
disp(tb_policy_long);

    a_idx    a_val     z_idx    z_val    pol_at_a_z
    _____    ______    _____    _____    __________

      1         0.1      1       -3       0.14979  
      1         0.1      2        0           1.1  
      1         0.1      3        3        20.186  
      2      12.575      1       -3        12.625  
      2      12.575      2        0        13.575  
      2      12.575      3        3        32.661  
      3       25.05      1       -3          25.1  
      3       25.05      2        0         26.05  
      3       25.05      3        3        45.136  
      4      37.525      1       -3        37.575  
      4      37.525      2        0        38.525  
      4      37.525      3        3        57.611  
      5          50      1       -3         50.05  
      5          50      2        0            51  
      5          50      3        3        70.086  </code></pre>
</div>
<div id="a-multidimensional-nd-array-with-many-nan-values" class="section level4" number="1.2.3.2">
<h4><span class="header-section-number">1.2.3.2</span> A Multidimensional ND Array with Many NaN Values</h4>
<p>Continue with the previous exercise, but now we have more than 2 state
variables.</p>
<p>Create a multidimensional Array with Many NaN Values. For example, we
could have a dynamic lifecycle model with three endogenous varaibles,
years of education accumulated, years of experiencesin blue and white
collar jobs. By age 22, after starting to work at age 16, there are
different possible combinations of G (schooling), X1 (white-collar), and
X2 (blue-collar) jobs. These are exclusive choices in each year, so at
age 16, assume that G = 0, X1 = 0 and X2 = 0. At age 16, they can choose
to stay at home, school, or X1, or X2, exclusively. G, X1, X2 accumulate
over time.</p>
<p>For each age, we can create multi-dimensional arrays with equal
dimension for G, X1 and X2, to record consumption, value, etc at each
element of the possible state-space. However, that matrix could have a
lot of empty values.</p>
<p>In the example below, also has a X3 (military category).</p>
<pre><code>% random number
rng(123);

% Max age means number of
MAX_YRS_POST16 = 3;

% store all
cl_EV = cell(MAX_YRS_POST16,1);

% Loop 1, solve BACKWARD
for it_yrs_post16=MAX_YRS_POST16:-1:1
    
    % Store some results, the matrix below includes all possible
    % state-space elements
    mn_ev_at_gx123 = NaN(it_yrs_post16, it_yrs_post16, it_yrs_post16, it_yrs_post16);
    
    % Loops 2, possibles Years attained so far as well as experiences
    for G=0:1:(it_yrs_post16-1)
        for X1=0:1:(it_yrs_post16-1-G)
            for X2=0:1:(it_yrs_post16-1-G-X1)
                for X3=0:1:(it_yrs_post16-1-G-X1-X2)
                    
                    % Double checkAre these combinations feasible?
                    if (G+X1+X2+X3 &lt;= it_yrs_post16)
                        % just plug in a random number
                        mn_ev_at_gx123(G+1, X1+1, X2+1, X3+1) = rand();
                    end
                end
            end
        end
    end
    
    % store matrixes
    cl_EV{it_yrs_post16} = mn_ev_at_gx123;
    
end

% Display Results
celldisp(cl_EV);


cl_EV{1} =
 
    0.6344



cl_EV{2} =
 

(:,:,1,1) =

    0.7380    0.5316
    0.5318       NaN


(:,:,2,1) =

    0.1755       NaN
       NaN       NaN


(:,:,1,2) =

    0.1825       NaN
       NaN       NaN


(:,:,2,2) =

   NaN   NaN
   NaN   NaN



cl_EV{3} =
 

(:,:,1,1) =

    0.6965    0.9808    0.3921
    0.3432    0.0597       NaN
    0.3980       NaN       NaN


(:,:,2,1) =

    0.5513    0.4809       NaN
    0.4386       NaN       NaN
       NaN       NaN       NaN


(:,:,3,1) =

    0.4231       NaN       NaN
       NaN       NaN       NaN
       NaN       NaN       NaN


(:,:,1,2) =

    0.2861    0.6848       NaN
    0.7290       NaN       NaN
       NaN       NaN       NaN


(:,:,2,2) =

    0.7195       NaN       NaN
       NaN       NaN       NaN
       NaN       NaN       NaN


(:,:,3,2) =

   NaN   NaN   NaN
   NaN   NaN   NaN
   NaN   NaN   NaN


(:,:,1,3) =

    0.2269       NaN       NaN
       NaN       NaN       NaN
       NaN       NaN       NaN


(:,:,2,3) =

   NaN   NaN   NaN
   NaN   NaN   NaN
   NaN   NaN   NaN


(:,:,3,3) =

   NaN   NaN   NaN
   NaN   NaN   NaN
   NaN   NaN   NaN</code></pre>
</div>
<div id="generate-a-two-dimensional-matrix-based-on-nd-array-for-only-non-nan-cell-values" class="section level4" number="1.2.3.3">
<h4><span class="header-section-number">1.2.3.3</span> Generate a Two Dimensional Matrix Based on ND Array for Only non-NaN Cell Values</h4>
<p>We can generate a 2-dimensional matrix, what we can consider as a Table,
with the information stored in the structures earlier. In this example,
we can drop the NaN values. This matrix will be much larger in size due
to explicitly storing X1, X2, X3 and G values then the ND array when
most values are not NaN. But this output matrix can be much more easily
interpretable and readable. When there are many many NaNs in the ND
array, this matrix could be much smaller in size.</p>
<p>First, convert each element of the cell array above to a 2D matrix (with
the same number of columns), then stack resulting matrixes together to
form one big table.</p>
<pre><code>% Create a 2D Array
for it_yrs_post16=MAX_YRS_POST16:-1:1
    % Get matrix at cell element
    mn_ev_at_gx123 = cl_EV{it_yrs_post16};
    % flaten multi-dimensional matrix
    ar_ev_at_gx123_flat = mn_ev_at_gx123(:);
    % find nan values
    ar_id_isnan = isnan(ar_ev_at_gx123_flat);
    % obtain dimension-specific index for nan positions
    [id_G, id_X1, id_X2, id_X3] = ind2sub(size(mn_ev_at_gx123), find(~ar_id_isnan));
    % generate 2-dimensional matrix (table)
    mt_ev_at_gx123 = [it_yrs_post16 + zeros(size(id_G)), ...
        (id_G-1), (id_X1-1), (id_X2-1), (id_X3-1), ...
        ar_ev_at_gx123_flat(~ar_id_isnan)];
    % stack results
    if (it_yrs_post16 == MAX_YRS_POST16)
        mt_ev_at_gx123_all = mt_ev_at_gx123;
    else
        mt_ev_at_gx123_all = [mt_ev_at_gx123_all; mt_ev_at_gx123];
    end
end
% Sort
mt_ev_at_gx123_all = sortrows(mt_ev_at_gx123_all, [1,2,3,4]);
% Create Table
tb_ev_at_gx123_all = array2table(mt_ev_at_gx123_all);
cl_col_names_a = {&#39;YRS_POST16&#39;, &#39;G&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;EV&#39;};
tb_ev_at_gx123_all.Properties.VariableNames = cl_col_names_a;
disp(tb_ev_at_gx123_all);

    YRS_POST16    G    X1    X2    X3       EV   
    __________    _    __    __    __    ________

        1         0    0     0     0       0.6344
        2         0    0     0     0        0.738
        2         0    0     0     1      0.18249
        2         0    0     1     0      0.17545
        2         0    1     0     0      0.53155
        2         1    0     0     0      0.53183
        3         0    0     0     0      0.69647
        3         0    0     0     1      0.28614
        3         0    0     0     2      0.22685
        3         0    0     1     0      0.55131
        3         0    0     1     1      0.71947
        3         0    0     2     0      0.42311
        3         0    1     0     0      0.98076
        3         0    1     0     1      0.68483
        3         0    1     1     0      0.48093
        3         0    2     0     0      0.39212
        3         1    0     0     0      0.34318
        3         1    0     0     1      0.72905
        3         1    0     1     0      0.43857
        3         1    1     0     0     0.059678
        3         2    0     0     0      0.39804</code></pre>
</div>
<div id="mesh-three-vectors-together-then-generate-a-flat-table" class="section level4" number="1.2.3.4">
<h4><span class="header-section-number">1.2.3.4</span> Mesh Three Vectors Together then Generate A Flat Table</h4>
<p>There are three parameters, quadratic of preference, height preference,
and reference points preference. Mesh three vectors together with
ndgrid. Then generate a flat table with the index of the parameters as
well as the values of the parameters.</p>
<pre><code>% Generate Arrays
[it_quadc, it_linh, it_refh] = deal(2, 2, 2);
ar_fl_quadc = linspace(-0.01, -0.001, it_quadc);
ar_fl_linh = linspace(0.01, 0.05, it_linh);
ar_fl_refh = linspace(-0.01, -0.05, it_refh);
% ndgrid mesh together
[mn_fl_quadc, ~] = ndgrid(ar_fl_quadc, ar_fl_linh, ar_fl_refh);
% combine
[ar_it_quadc_idx, ar_it_linh_idx, ar_it_refh_idx] = ind2sub(size(mn_fl_quadc), find(mn_fl_quadc));
% Index and values
mt_paramsmesh_long = [ar_it_quadc_idx, ar_fl_quadc(ar_it_quadc_idx)&#39;, ...
    ar_it_linh_idx, ar_fl_linh(ar_it_linh_idx)&#39;, ...
    ar_it_refh_idx, ar_fl_refh(ar_it_refh_idx)&#39;];
% Sort by a and z
mt_paramsmesh_long = sortrows(mt_paramsmesh_long, [1,3, 5]);</code></pre>
<p>Generate a table with Column names:</p>
<pre><code>% Create Table
tb_paramsmesh_long = array2table(mt_paramsmesh_long);
cl_col_names_a = {&#39;quadc_idx&#39;, &#39;quadc_val&#39;, &#39;linh_idx&#39;, &#39;linh_val&#39;, &#39;refh_idx&#39;, &#39;rehfh_val&#39;};
tb_paramsmesh_long.Properties.VariableNames = cl_col_names_a;
disp(tb_paramsmesh_long);

    quadc_idx    quadc_val    linh_idx    linh_val    refh_idx    rehfh_val
    _________    _________    ________    ________    ________    _________

        1          -0.01         1          0.01         1          -0.01  
        1          -0.01         1          0.01         2          -0.05  
        1          -0.01         2          0.05         1          -0.01  
        1          -0.01         2          0.05         2          -0.05  
        2         -0.001         1          0.01         1          -0.01  
        2         -0.001         1          0.01         2          -0.05  
        2         -0.001         2          0.05         1          -0.01  
        2         -0.001         2          0.05         2          -0.05  </code></pre>

</div>
</div>
</div>
<div id="cells" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Cells</h2>

<div id="matlab-cell-array-basic-operations" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Matlab Cell Array Basic Operations</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="string-combine-with-string-cell" class="section level4" number="1.3.1.1">
<h4><span class="header-section-number">1.3.1.1</span> String Combine with string cell</h4>
<pre><code>ls_st_param_key = {&#39;fl_crra&#39;, &#39;fl_beta&#39;, ...
                   &#39;fl_w&#39;, &#39;fl_r_save&#39;, ...
                   &#39;fl_a_max&#39;, &#39;it_z_n&#39;, &#39;it_a_n&#39;};
cl_st_param_keys = {&#39;fl_wad&#39;, &#39;fl_betart&#39;, &#39;it_z_nfg&#39;};
st_param = &#39;asdjfl&#39;;
disp([{st_param}, ls_st_param_key, cl_st_param_keys]);

  Columns 1 through 10

    {&#39;asdjfl&#39;}    {&#39;fl_crra&#39;}    {&#39;fl_beta&#39;}    {&#39;fl_w&#39;}    {&#39;fl_r_save&#39;}    {&#39;fl_a_max&#39;}    {&#39;it_z_n&#39;}    {&#39;it_a_n&#39;}    {&#39;fl_wad&#39;}    {&#39;fl_betart&#39;}

  Column 11

    {&#39;it_z_nfg&#39;}</code></pre>

</div>
</div>
<div id="matlab-list-comprehension-with-cells" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Matlab List Comprehension with Cells</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="concatenate-numeric-values-as-string-with-trimming" class="section level4" number="1.3.2.1">
<h4><span class="header-section-number">1.3.2.1</span> Concatenate Numeric Values as String with Trimming</h4>
<p>There is a list of numbers, combine (paste) to single string with some
connector, trim each element to eliminate spaces.</p>
<pre><code>rng(123,&#39;philox&#39;)
ar_rand = rand([5,1]);
st_fl_rand = string(num2str(ar_rand));
st_untrimmmed = strjoin(st_fl_rand, &quot;#&quot;);
cl_st_trimmmed = cellfun(@(x) strtrim(x), cellstr(st_fl_rand), &#39;UniformOutput&#39;, false);
st_trimmmed = strjoin(string(cl_st_trimmmed), &quot;#&quot;);
disp([&#39;st_untrimmmed:&#39; st_untrimmmed]);

    &quot;st_untrimmmed:&quot;    &quot;  0.53162##  0.60704##  0.31843#0.0016474##  0.65784&quot;

disp([&#39;st_trimmmed:&#39; st_trimmmed]);

    &quot;st_trimmmed:&quot;    &quot;0.53162#0.60704#0.31843#0.0016474#0.65784&quot;</code></pre>
</div>
<div id="find-index-of-elements-of-string-cells-in-a-larger-string-cells" class="section level4" number="1.3.2.2">
<h4><span class="header-section-number">1.3.2.2</span> Find Index of Elements of String Cells in a larger String Cells</h4>
<p>the function below returns the position of cl_st_param_keys in
ls_st_param_key should only include in cl_st_param_keys strings that
also exist in ls_st_param_key.</p>
<pre><code>ls_st_param_key = {&#39;fl_crra&#39;, &#39;fl_beta&#39;, ...
                   &#39;fl_w&#39;, &#39;fl_r_save&#39;, ...
                   &#39;fl_a_max&#39;, &#39;it_z_n&#39;, &#39;it_a_n&#39;};

cl_st_param_keys = {&#39;fl_w&#39;, &#39;fl_beta&#39;, &#39;it_z_n&#39;};

cell2mat(cellfun(@(m) find(strcmp(ls_st_param_key, m)), ...
                 cl_st_param_keys, &#39;UniformOutput&#39;, false))

ans = 1x3    
     3     2     6</code></pre>
</div>
<div id="given-container-of-arrays-find-total-length-of-all-arrays-for-selected-keys" class="section level4" number="1.3.2.3">
<h4><span class="header-section-number">1.3.2.3</span> Given Container of Arrays, Find Total Length of All Arrays for Selected Keys</h4>
<pre><code>cl_st_param_keys = {&#39;fl_crra&#39;, &#39;fl_beta&#39;};

param_tstar_map = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
it_simu_vec_len = 5;

param_tstar_map(&#39;fl_crra&#39;) = linspace(1, 2, 5);
param_tstar_map(&#39;fl_beta&#39;) = linspace(0.94, 0.98, 10);
param_tstar_map(&#39;w&#39;) = linspace(1.1, 1.4, it_simu_vec_len);
param_tstar_map(&#39;r&#39;) = linspace(0.01, 0.04, it_simu_vec_len);

ar_it_array_len = cell2mat(cellfun(@(m) length(param_tstar_map(m)), ...
                           cl_st_param_keys, &#39;UniformOutput&#39;, false));

it_total_length = sum(ar_it_array_len);
disp([&#39;ar_it_array_len: &#39; num2str(ar_it_array_len)])

ar_it_array_len: 5  10

disp([&#39;it_total_length: &#39; num2str(it_total_length)])

it_total_length: 15</code></pre>
</div>
<div id="given-container-of-arrays-find-min-and-max-of-each-and-draw-random-n-sets" class="section level4" number="1.3.2.4">
<h4><span class="header-section-number">1.3.2.4</span> Given Container of Arrays, Find Min and Max of Each and Draw Random N sets</h4>
<pre><code>cl_st_param_keys = {&#39;fl_crra&#39;, &#39;fl_beta&#39;};

param_tstar_map = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
it_simu_vec_len = 5;

param_tstar_map(&#39;fl_crra&#39;) = linspace(1, 2, 5);
param_tstar_map(&#39;fl_beta&#39;) = linspace(0.94, 0.98, 10);
param_tstar_map(&#39;w&#39;) = linspace(1.1, 1.4, it_simu_vec_len);
param_tstar_map(&#39;r&#39;) = linspace(0.01, 0.04, it_simu_vec_len);

rng(123);
it_simu_length = 20;
mt_param_rand = cell2mat(cellfun(@(m) ...
                           rand([it_simu_length,1]).*(max(param_tstar_map(m)) - min(param_tstar_map(m))) ...
                           + min(param_tstar_map(m)), ...
                           cl_st_param_keys, &#39;UniformOutput&#39;, false));

tb_rand_draws = array2table(mt_param_rand, &#39;VariableNames&#39;, cl_st_param_keys);

disp(tb_rand_draws);

    fl_crra    fl_beta
    _______    _______

    1.5316     0.97337
     1.607     0.97305
    1.3184     0.94644
    1.0016     0.97349
    1.6578     0.94983
    1.7505     0.97152
    1.7407     0.94277
    1.7108     0.94781
    1.3542     0.97625
    1.1479     0.95709
    1.8834     0.94962
    1.1274     0.96042
    1.2132     0.96637
    1.0676     0.94936
    1.4318     0.96911
    1.3791     0.97365
    1.9399     0.94242
    1.6369     0.96946
    1.9791     0.95752
    1.5709     0.96145</code></pre>

</div>
</div>
<div id="all-possible-combinations-of-multiple-arrays" class="section level3" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> All Possible Combinations of Multiple Arrays</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="given-several-arrays-of-possibly-different-length-in-container-all-possible-combinations" class="section level4" number="1.3.3.1">
<h4><span class="header-section-number">1.3.3.1</span> Given Several Arrays of Possibly different Length in Container, all Possible combinations</h4>
<pre><code>param_tstar_map = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_tstar_map(&#39;a&#39;) = linspace(1, 5, 5);
param_tstar_map(&#39;b&#39;) = linspace(0.87, 0.97, 6);
param_tstar_map(&#39;c&#39;) = linspace(0, 0.5, 10);

cl_st_param_keys = {&#39;a&#39;,&#39;c&#39;};
cl_ar_param_subset_values = values(param_tstar_map, {&#39;a&#39;,&#39;c&#39;});

cl_mt_all = cl_ar_param_subset_values;
[cl_mt_all{:}] = ndgrid(cl_ar_param_subset_values{:});
mt_param_vals_combi = cell2mat(cellfun(@(m) m(:), cl_mt_all, &#39;uni&#39;, 0));

tb_all_combi = array2table(mt_param_vals_combi, &#39;VariableNames&#39;, cl_st_param_keys);

disp(tb_all_combi);

    a       c    
    _    ________

    1           0
    2           0
    3           0
    4           0
    5           0
    1    0.055556
    2    0.055556
    3    0.055556
    4    0.055556
    5    0.055556
    1     0.11111
    2     0.11111
    3     0.11111
    4     0.11111
    5     0.11111
    1     0.16667
    2     0.16667
    3     0.16667
    4     0.16667
    5     0.16667
    1     0.22222
    2     0.22222
    3     0.22222
    4     0.22222
    5     0.22222
    1     0.27778
    2     0.27778
    3     0.27778
    4     0.27778
    5     0.27778
    1     0.33333
    2     0.33333
    3     0.33333
    4     0.33333
    5     0.33333
    1     0.38889
    2     0.38889
    3     0.38889
    4     0.38889
    5     0.38889
    1     0.44444
    2     0.44444
    3     0.44444
    4     0.44444
    5     0.44444
    1         0.5
    2         0.5
    3         0.5
    4         0.5
    5         0.5</code></pre>

</div>
</div>
<div id="nested-cells" class="section level3" number="1.3.4">
<h3><span class="header-section-number">1.3.4</span> Nested Cells</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="nested-cells-and-access" class="section level4" number="1.3.4.1">
<h4><span class="header-section-number">1.3.4.1</span> Nested Cells and access</h4>
<pre><code>cl_st_param_keys = {&#39;fl_crra&#39;, &#39;fl_beta&#39;};

it_simu_vec_len = 3;
clns_parm_tstar = cell([4,1]);
clns_parm_tstar{1} = {&#39;fl_crra&#39;, &#39;CRRA&#39;, linspace(1, 2, it_simu_vec_len)};
clns_parm_tstar{2} = {&#39;fl_beta&#39;, &#39;Discount&#39;, linspace(0.94, 0.98, it_simu_vec_len)};
clns_parm_tstar{3} = {&#39;w&#39;, &#39;Wage&#39;, linspace(1.1, 1.4, it_simu_vec_len)};
clns_parm_tstar{4} = {&#39;r&#39;, &#39;Save Interest&#39;, linspace(0.01, 0.04, it_simu_vec_len)};

disp(clns_parm_tstar(1));

    {1x3 cell}

disp(clns_parm_tstar{1}{1})

fl_crra

disp(clns_parm_tstar{1}{2});

CRRA

disp(clns_parm_tstar{1}{3});

    1.0000    1.5000    2.0000</code></pre>

</div>
</div>
</div>
<div id="characters-and-strings" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Characters and Strings</h2>

<div id="basic-string-operations-display-search-join-and-split" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Basic String Operations, Display, Search, Join and Split</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="date-string" class="section level4" number="1.4.1.1">
<h4><span class="header-section-number">1.4.1.1</span> Date String</h4>
<p>Generate a string based on date and time as file suffix.</p>
<pre><code>st_file_suffix = [&#39;_d&#39; datestr(now,&#39;yymmdd_tHHMMSS&#39;)];
disp(st_file_suffix);

_d210701_t094001</code></pre>
</div>
<div id="combine-string-numeric-values-etc-single-and-double-quotes" class="section level4" number="1.4.1.2">
<h4><span class="header-section-number">1.4.1.2</span> Combine String, Numeric values etc, Single and Double Quotes</h4>
<p>Convert a string array into a single string, note the double quotes, and
the auto space between:</p>
<pre><code>st_a = &quot;another string&quot;;
ar_st = [&quot;abc&quot;, num2str(2), &quot;opq&quot;, st_a];
disp(strjoin(ar_st));

abc 2 opq another string</code></pre>
<p>If we do not want to have spaces between words, the second parameter for
strjoin allows for string connectors:</p>
<pre><code>st_a = &quot;another string&quot;;
ar_st = [&quot;abc&quot;, num2str(2), &quot;opq&quot;, st_a];
disp(strjoin(ar_st, &quot;&quot;));

abc2opqanother string</code></pre>
<p>With single quotes, the str element is not an array, so does not need
strjoin, but not need to have spaces:</p>
<pre><code>st_a = &#39;another string&#39;;
str = [&#39;abc &#39;, num2str(2), &#39; opq &#39;, st_a];
disp((str));

abc 2 opq another string</code></pre>
</div>
<div id="construct-string-print-statement-with-string-and-numeric-elements" class="section level4" number="1.4.1.3">
<h4><span class="header-section-number">1.4.1.3</span> Construct String Print Statement with String and Numeric Elements</h4>
<p>In the example below, we have a number of strings we want to put inside
a string array, then join with strjoin, but two of the strings need to
be constructed as strings first. Note below that double quoates are own
strings, single quotes in brackets constructing additional strings.</p>
<pre><code>st_a = &quot;another string&quot;;
ar_st = [&quot;abc&quot;, &quot;efg&quot;];
ar_fl_vals = rand([1,3]);
st_print = strjoin(...
    [&quot;Completed SNW_DS_MAIN:&quot;, ...
    [&#39;SNW_MP_PARAM=&#39; num2str(123)], ...
    [&#39;SNW_MP_CONTROL=&#39; num2str(678)], ...
    [&#39;STR_VAR1=&#39; char(&#39;string&#39;)], ...
    [&#39;STR_VAR2=&#39; char(strjoin(ar_st, &quot;-&quot;))], ...
    [&#39;STR_VAR3:;&#39; char(strjoin(ar_st, &quot;;&quot;))], ...
    [&#39;ar_st:;&#39; char(strjoin(strcat( ...
    num2str((1:length(ar_st))&#39;, &#39;%0.3d&#39;), &#39;=&#39;, ar_st&#39; ...
    ), &quot;;&quot;))], ...
    [&#39;ar_fl_vals:;&#39; strjoin(string(strcat( ...
    num2str((1:length(ar_fl_vals))&#39;, &#39;%0.3d&#39;), &#39;=&#39;, num2str(ar_fl_vals&#39;, &#39;%3.2f&#39;))), &quot;;&quot;)], ...
    ], &quot;;&quot;);
% Ways to print
st_out = st_print;
ar_ch_out = char(strsplit(st_print,&quot;;&quot;)&#39;);
ar_st_out = strsplit(st_print,&quot;;&quot;)&#39;;
% Print
disp(st_out);

Completed SNW_DS_MAIN:;SNW_MP_PARAM=123;SNW_MP_CONTROL=678;STR_VAR1=string;STR_VAR2=abc-efg;STR_VAR3:;abc;efg;ar_st:;001=abc;002=efg;ar_fl_vals:;;001=0.87;002=0.25;003=0.48

disp(ar_ch_out);

Completed SNW_DS_MAIN:
SNW_MP_PARAM=123      
SNW_MP_CONTROL=678    
STR_VAR1=string       
STR_VAR2=abc-efg      
STR_VAR3:             
abc                   
efg                   
ar_st:                
001=abc               
002=efg               
ar_fl_vals:           
001=0.87              
002=0.25              
003=0.48              

disp(ar_st_out);

    &quot;Completed SNW_DS_MAIN:&quot;
    &quot;SNW_MP_PARAM=123&quot;
    &quot;SNW_MP_CONTROL=678&quot;
    &quot;STR_VAR1=string&quot;
    &quot;STR_VAR2=abc-efg&quot;
    &quot;STR_VAR3:&quot;
    &quot;abc&quot;
    &quot;efg&quot;
    &quot;ar_st:&quot;
    &quot;001=abc&quot;
    &quot;002=efg&quot;
    &quot;ar_fl_vals:&quot;
    &quot;001=0.87&quot;
    &quot;002=0.25&quot;
    &quot;003=0.48&quot;</code></pre>
</div>
<div id="paste-join-strings-together-with-separator" class="section level4" number="1.4.1.4">
<h4><span class="header-section-number">1.4.1.4</span> Paste Join Strings Together with Separator</h4>
<p>Join strings together with separator, this is similar to the paste0
function in R.</p>
<pre><code>ar_st = [&quot;abc&quot;, &quot;efg&quot;, &quot;opq&quot;];
disp(strjoin(ar_st, &#39;-&#39;));

abc-efg-opq</code></pre>
</div>
<div id="combine-char-with-numeric-value" class="section level4" number="1.4.1.5">
<h4><span class="header-section-number">1.4.1.5</span> Combine Char with Numeric Value</h4>
<p>Compose a string with words and numerical values</p>
<pre><code>st_title = strcat(&quot;Figure Title &quot;, ...
    &quot;(&quot;, ...
    &quot;threedeci=%.3f,&quot;, ...
    &quot;twodeci=%.2f,&quot;, ...
    &quot;int=%.0f&quot;, ...
    &quot;)&quot;);
ar_params = 123.4567 + zeros(1,3);
st_combo = compose(st_title, ar_params);
disp(st_combo);

Figure Title (threedeci=123.457,twodeci=123.46,int=123)</code></pre>
</div>
<div id="search-if-string-contains-substring" class="section level4" number="1.4.1.6">
<h4><span class="header-section-number">1.4.1.6</span> Search if String Contains Substring</h4>
<p>Does string contain substring?</p>
<pre><code>st_long1 = &#39;simu_dense&#39;;
st_long2 = &#39;simu_denser&#39;;
st_long3 = &#39;simuverydense&#39;;
st_long4 = &#39;simu_medium&#39;;
st_long5 = &#39;simuverysmall&#39;;
disp([contains(st_long1, &#39;dense&#39;), contains(st_long2, &#39;dense&#39;), contains(st_long3, &#39;dense&#39;), ...
    contains(st_long4, &#39;dense&#39;), contains(st_long5, &#39;dense&#39;)]);

   1   1   1   0   0</code></pre>
</div>
<div id="find-elements-of-an-array-that-matches-any-elements-of-another-array" class="section level4" number="1.4.1.7">
<h4><span class="header-section-number">1.4.1.7</span> Find Elements of an Array that Matches Any Elements of Another Array</h4>
<p>There is an array of strings, check if each element equals values
specified in another string, using the match function.</p>
<pre><code>% String array from strings
ar_st_long = string({st_long1, st_long2, st_long3, st_long4, st_long5});
% If matches simu_dense
disp(matches(ar_st_long, &#39;simu_dense&#39;));

   1   0   0   0   0

% If matches simu_dense or simu_denser
disp(matches(ar_st_long, [&quot;simu_dense&quot;, &quot;simu_denser&quot;]));

   1   1   0   0   0</code></pre>
</div>
<div id="change-file-name-mlx-to-m" class="section level4" number="1.4.1.8">
<h4><span class="header-section-number">1.4.1.8</span> Change File Name MLX to M</h4>
<pre><code>st_file_name_mlx = &#39;continuous_differentiable.mlx&#39;;
at_st_split_file_name = split(st_file_name_mlx, &quot;.&quot;);
st_file_name_m = strcat(at_st_split_file_name{1}, &#39;_m.m&#39;);
disp(st_file_name_m);

continuous_differentiable_m.m</code></pre>

</div>
</div>
<div id="string-array-manipulations-join-find-replace-and-the-alphabet" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> String Array Manipulations, Join, Find, Replace and the Alphabet</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="generate-a-string-array-from-strings" class="section level4" number="1.4.2.1">
<h4><span class="header-section-number">1.4.2.1</span> Generate a String Array from Strings</h4>
<p>Empty String Array and fill with values.</p>
<pre><code>ar_st_titles = strings([3,1]);
ar_st_titles(1) = &#39;Title1&#39;;
ar_st_titles(2) = &#39;Title2&#39;;
ar_st_titles(3) = &#39;Title3&#39;;
disp(ar_st_titles);

    &quot;Title1&quot;
    &quot;Title2&quot;
    &quot;Title3&quot;</code></pre>
<p>Three title lines, with double quotes:</p>
<pre><code>ar_st_titles = [&quot;Title1&quot;,&quot;Title2&quot;,&quot;Title3&quot;]&#39;;
disp(ar_st_titles);

    &quot;Title1&quot;
    &quot;Title2&quot;
    &quot;Title3&quot;</code></pre>
<p>Three words, joined together, now single quotes, this creates one
string, rather than a string array:</p>
<pre><code>st_titles = [&#39;Title1&#39;,&#39;Title2&#39;,&#39;Title3&#39;];
disp(st_titles);

Title1Title2Title3</code></pre>
<p>Given some previously defined chars or strings with single or double
quotes, not sure which. To safely generate a string array, wrap in
brackets and then conver with string function. This generates a string
array whether the original inputs were single or double quoted:</p>
<pre><code>st_a = &#39;a&#39;;
st_b = &#39;b&#39;;
st_c = &#39;c&#39;;
st_a_dq = &quot;a&quot;;
st_b_dq = &quot;b&quot;;
st_c_dq = &quot;c&quot;;
ar_st_singlequotes = string({st_a, st_b, st_c});
ar_st_doublequotes = string({st_a_dq, st_b_dq, st_c_dq});
disp([&quot;st_singlequotes&quot; ar_st_singlequotes]);

    &quot;st_singlequotes&quot;    &quot;a&quot;    &quot;b&quot;    &quot;c&quot;

disp([&quot;ar_st_doublequotes&quot; ar_st_doublequotes]);

    &quot;ar_st_doublequotes&quot;    &quot;a&quot;    &quot;b&quot;    &quot;c&quot;</code></pre>
<p>Convert the string array to a cell string array</p>
<pre><code>disp(cellstr(ar_st_doublequotes));

    {&#39;a&#39;}    {&#39;b&#39;}    {&#39;c&#39;}</code></pre>
</div>
<div id="string-cell-array" class="section level4" number="1.4.2.2">
<h4><span class="header-section-number">1.4.2.2</span> String Cell Array</h4>
<p>Create a string array:</p>
<pre><code>ar_st_title_one = {&#39;Title One Line&#39;};
ar_st_titles = {&#39;Title1&#39;,&#39;Title2&#39;,&#39;Title3&#39;};
disp(ar_st_title_one);

    {&#39;Title One Line&#39;}

disp(ar_st_titles);

    {&#39;Title1&#39;}    {&#39;Title2&#39;}    {&#39;Title3&#39;}</code></pre>
<p>Add to a string array:</p>
<pre><code>ar_st_titles{4} = &#39;Title4&#39;;
disp(ar_st_titles);

    {&#39;Title1&#39;}    {&#39;Title2&#39;}    {&#39;Title3&#39;}    {&#39;Title4&#39;}</code></pre>
<p>Update one of the strings:</p>
<pre><code>ar_st_title_one{1} = strcat(&#39;log(&#39;, ar_st_title_one{1},&#39;)&#39;);
ar_st_titles{1} = strcat(&#39;log(&#39;, ar_st_titles{1},&#39;)&#39;);
disp(ar_st_title_one);

    {&#39;log(Title One Line)&#39;}

disp(ar_st_titles);

    {&#39;log(Title1)&#39;}    {&#39;Title2&#39;}    {&#39;Title3&#39;}    {&#39;Title4&#39;}</code></pre>
</div>
<div id="joint-string-cell-array-with-suffix" class="section level4" number="1.4.2.3">
<h4><span class="header-section-number">1.4.2.3</span> Joint String Cell Array with Suffix</h4>
<pre><code>ar_st_titles = {&#39;Title1&#39;,&#39;Title2&#39;,&#39;Title3&#39;};
disp(strcat(ar_st_titles, &#39;_init&#39;));

    {&#39;Title1_init&#39;}    {&#39;Title2_init&#39;}    {&#39;Title3_init&#39;}</code></pre>
</div>
<div id="duplicate-string" class="section level4" number="1.4.2.4">
<h4><span class="header-section-number">1.4.2.4</span> Duplicate String</h4>
<pre><code>it_duplicate_n = 10;
disp(repmat({&#39;String&#39;}, [1, it_duplicate_n]));

  Columns 1 through 9

    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}    {&#39;String&#39;}

  Column 10

    {&#39;String&#39;}</code></pre>
</div>
<div id="string-join-to-form-single-element" class="section level4" number="1.4.2.5">
<h4><span class="header-section-number">1.4.2.5</span> String Join to form Single Element</h4>
<p>using char() is safe</p>
<pre><code>st_var_name = &quot;abc&quot;

st_var_name = &quot;abc&quot;

st_var_name = [st_var_name &#39; percentile values&#39;]

st_var_name = 1x2 string    
&quot;abc&quot;        &quot; percentile values&quot;    

strjoin(st_var_name)

ans = &quot;abc  percentile values&quot;


st_var_name = &quot;abc&quot;

st_var_name = &quot;abc&quot;

st_var_name = [char(st_var_name) &#39; percentile values&#39;]

st_var_name = &#39;abc percentile values&#39;


st_var_name = &#39;abc&#39;

st_var_name = &#39;abc&#39;

st_var_name = [char(st_var_name) &#39; percentile values&#39;]

st_var_name = &#39;abc percentile values&#39;</code></pre>
</div>
<div id="string-join-dash-paste" class="section level4" number="1.4.2.6">
<h4><span class="header-section-number">1.4.2.6</span> String Join dash (Paste)</h4>
<p>This is similar to R’s paste function:</p>
<pre><code>st_var_name = &quot;abc&quot;;
st_var_name = [st_var_name, &#39;efg&#39;, &#39;mqo&#39;];
disp(strjoin(st_var_name, &quot;_&quot;));

abc_efg_mqo

disp(strjoin(st_var_name, &quot;,&quot;));

abc,efg,mqo</code></pre>
</div>
<div id="numeric-array-to-string-without-space" class="section level4" number="1.4.2.7">
<h4><span class="header-section-number">1.4.2.7</span> Numeric Array to String without Space</h4>
<p>String replace</p>
<pre><code>ar_it_test_grp = [3, 8, 9];
strrep(num2str(ar_it_test_grp), &#39;  &#39;, &#39;_&#39;)

ans = &#39;3_8_9&#39;</code></pre>
</div>
<div id="substring-replace-in-cell-array" class="section level4" number="1.4.2.8">
<h4><span class="header-section-number">1.4.2.8</span> Substring replace in Cell Array</h4>
<pre><code>ar_st_cells = {&#39;shock=0.35&#39;,&#39;shock=0.40&#39;,&#39;shock=0.46&#39;};
ar_st_updated_cells = strrep(ar_st_cells, &#39;shock&#39;, &#39;$\epsilon$&#39;);
disp(ar_st_updated_cells);

    {&#39;$\epsilon$=0.35&#39;}    {&#39;$\epsilon$=0.40&#39;}    {&#39;$\epsilon$=0.46&#39;}</code></pre>
</div>
<div id="find-position-of-string-in-string-cell" class="section level4" number="1.4.2.9">
<h4><span class="header-section-number">1.4.2.9</span> Find position of String in String Cell</h4>
<pre><code>ls_st_param_key = {&#39;fl_crra&#39;, &#39;fl_beta&#39;, ...
                   &#39;fl_w&#39;, &#39;fl_r_save&#39;, ...
                   &#39;fl_a_max&#39;, &#39;it_z_n&#39;, &#39;it_a_n&#39;};
st_param_key = &#39;fl_a_max&#39;;
find(strcmp(ls_st_param_key, st_param_key))

ans = 5</code></pre>
</div>
<div id="find-the-positions-of-string-cells-in-full-string-cells" class="section level4" number="1.4.2.10">
<h4><span class="header-section-number">1.4.2.10</span> Find the positions of String Cells in Full String Cells</h4>
<p>Find the positions of fl_w, fl_beta, and it_z_n in ls_st_param_key.
Then just find the position of fl_crra. When looking for the position of
something that does not exist, generate an find outcome array of length
0.</p>
<pre><code>ls_st_param_key = {&#39;fl_crra&#39;, &#39;fl_beta&#39;, ...
                   &#39;fl_w&#39;, &#39;fl_r_save&#39;, ...
                   &#39;fl_a_max&#39;, &#39;it_z_n&#39;, &#39;it_a_n&#39;};

cl_st_param_keys = {&#39;fl_w&#39;, &#39;fl_beta&#39;, &#39;it_z_n&#39;};

cell2mat(cellfun(@(m) find(strcmp(ls_st_param_key, m)), ...
                 cl_st_param_keys, &#39;UniformOutput&#39;, false))

ans = 1x3    
     3     2     6

find(strcmp(ls_st_param_key, &#39;fl_crra&#39;))

ans = 1

length(find(strcmp(ls_st_param_key, &#39;fl_crra_not_exist&#39;)))

ans = 0

~sum(strcmp(ls_st_param_key, &#39;fl_crra_not_exist&#39;))

ans = 
   1</code></pre>
</div>
<div id="cell-to-string-paste-and-replace-dash" class="section level4" number="1.4.2.11">
<h4><span class="header-section-number">1.4.2.11</span> Cell to string Paste and Replace dash</h4>
<pre><code>cl_st_param_keys = {&#39;fl_crra&#39;, &#39;fl_beta&#39;};
display(strrep(strjoin(cl_st_param_keys, &#39;-&#39;), &#39;_&#39;, &#39;\_&#39;));

fl\_crra-fl\_beta</code></pre>
</div>
<div id="generate-alphebetical-string-array-from-a-to-z" class="section level4" number="1.4.2.12">
<h4><span class="header-section-number">1.4.2.12</span> Generate Alphebetical String Array from A to Z</h4>
<p>Generate a single string that is A to Z, then generate this as a string
array.</p>
<pre><code>% a to z single string
st_a2z = &#39;a&#39;:&#39;z&#39;;
% a to z array of letters
ar_st_a2z = string((&#39;A&#39;:&#39;Z&#39;)&#39;)&#39;;
% Display
disp(st_a2z);

abcdefghijklmnopqrstuvwxyz

disp(ar_st_a2z);

  Columns 1 through 18

    &quot;A&quot;    &quot;B&quot;    &quot;C&quot;    &quot;D&quot;    &quot;E&quot;    &quot;F&quot;    &quot;G&quot;    &quot;H&quot;    &quot;I&quot;    &quot;J&quot;    &quot;K&quot;    &quot;L&quot;    &quot;M&quot;    &quot;N&quot;    &quot;O&quot;    &quot;P&quot;    &quot;Q&quot;    &quot;R&quot;

  Columns 19 through 26

    &quot;S&quot;    &quot;T&quot;    &quot;U&quot;    &quot;V&quot;    &quot;W&quot;    &quot;X&quot;    &quot;Y&quot;    &quot;Z&quot;</code></pre>

</div>
</div>
<div id="convert-and-concatenate-strings-arrays-with-numbers-and-number-arrays-with-strings" class="section level3" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Convert and Concatenate Strings Arrays with Numbers and Number Arrays with Strings</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="generate-a-string-from-numeric-array-and-print-on-screen-with-counter" class="section level4" number="1.4.3.1">
<h4><span class="header-section-number">1.4.3.1</span> Generate a String from Numeric Array and Print on Screen with Counter</h4>
<p>Want to quickly print on screen an array of number with the array name
and a counter printed before each value.</p>
<pre><code>% An array of numbers to print
rng(123);
ar_fl_values = rand(5,1);
% A string array of counters with leading zeros for even display
ar_st_counter_leading0 = num2str((1:length(ar_fl))&#39;, &#39;%0.3d&#39;);
% A float array of value formatted
ar_fl_values_formated = num2str(ar_fl&#39;, &#39;%3.2f&#39;);
ar_ch_values_display = strcat(&#39;fl_val, c&#39;, ar_st_counter_leading0, &#39;=&#39;, ar_fl_values_formated);
% print
disp(ar_ch_values_display);

fl_val, c001=0.78
fl_val, c002=0.29
fl_val, c003=0.31
fl_val, c004=0.67
fl_val, c005=0.11
fl_val, c006=0.66
fl_val, c007=0.89
fl_val, c008=0.70
fl_val, c009=0.44
fl_val, c010=0.44</code></pre>
</div>
<div id="combine-a-string-array-with-a-numeric-array-using-compose" class="section level4" number="1.4.3.2">
<h4><span class="header-section-number">1.4.3.2</span> Combine A String Array with a Numeric Array using Compose</h4>
<p>String array and numeric array, combine together using the compose
function, and test different formatting functions. Formating with
leading empty spaces, leading zeros, and convert to integer or not.</p>
<pre><code>st_titles = [&quot;%.3f&quot;,   &quot;%.1f&quot;,   &quot;%.0f&quot;;...
             &quot;%6.3f&quot;,  &quot;%6.1f&quot;,  &quot;%6.0f&quot;;...
             &quot;%06.3f&quot;, &quot;%06.1f&quot;, &quot;%06.0f&quot;];
ar_params = 123.4567890 + zeros(3,3);
st_combo = compose(st_titles, ar_params);
disp(st_combo);

    &quot;123.457&quot;    &quot;123.5&quot;     &quot;123&quot;   
    &quot;123.457&quot;    &quot; 123.5&quot;    &quot;   123&quot;
    &quot;123.457&quot;    &quot;0123.5&quot;    &quot;000123&quot;</code></pre>
<p>A string array and a numeric array combined</p>
<pre><code>ls_st_param_esti = {&#39;ar_mu_pos_1&#39;, &#39;ar_COEF_U_gamma&#39;};
ar_params = [1213,456];
st_combo = strcat(ls_st_param_esti&#39;, &#39;=&#39;, num2str(ar_params&#39;));
disp(st_combo);

    {&#39;ar_mu_pos_1=1213&#39;    }
    {&#39;ar_COEF_U_gamma= 456&#39;}</code></pre>
</div>
<div id="numeric-array-to-string-array-with-decimal-formatting" class="section level4" number="1.4.3.3">
<h4><span class="header-section-number">1.4.3.3</span> Numeric Array to String Array with Decimal Formatting</h4>
<p>There is a numeric array, format with a certain number of decimal
points, and convert to string array.</p>
<pre><code>% Inputs
rng(123);
ar_params = [1.23324, 493.1232, 4994.1111, 123];
st_rounding = &#39;.3f&#39;;
% Rounding and to string array
ar_st_params = compose(strcat(&quot;%&quot;, st_rounding), ar_params);
% Display:
disp(ar_st_params);

    &quot;1.233&quot;    &quot;493.123&quot;    &quot;4994.111&quot;    &quot;123.000&quot;</code></pre>
</div>
<div id="title-from-an-array-of-values" class="section level4" number="1.4.3.4">
<h4><span class="header-section-number">1.4.3.4</span> Title from an Array of Values</h4>
<p>There is a vector of parameter values and a vector of names for these
parameter values, I want to include these in the title of a figure with
the same decimal formating.</p>
<pre><code>% Inputs
rng(123);
ar_params = rand(1,3);
ar_st_parms_names = [&quot;param1&quot;, &quot;param2&quot;, &quot;param3&quot;];
st_rounding = &#39;.2f&#39;;
st_title_main = &quot;this is the figure title&quot;;
% Rounding and combining
ar_st_params = strcat(ar_st_parms_names, compose(strcat(&quot;=%&quot;, st_rounding), ar_params));
% Generate a Single String that is comma separated:
st_param_pasted = strjoin(ar_st_params, &#39;, &#39;);
% Generate title with parameters
st_title_wth_params = strcat(st_title_main, &#39; (&#39;, st_param_pasted, &#39;)&#39;);
% Display:
disp(st_title_wth_params);

this is the figure title (param1=0.70, param2=0.29, param3=0.23)</code></pre>
</div>
<div id="combine-string-with-numeric-array" class="section level4" number="1.4.3.5">
<h4><span class="header-section-number">1.4.3.5</span> Combine String with Numeric Array</h4>
<p>Example 1:</p>
<pre><code>ar_fl_abc1 = [0.4 0.1 0.25 0.3 0.4];
disp([num2str(ar_fl_abc1&#39;, &#39;zw=%3.2f;&#39;), num2str(ar_fl_abc1&#39;, &#39;zr=%3.2f&#39;)]);

zw=0.40;zr=0.40
zw=0.10;zr=0.10
zw=0.25;zr=0.25
zw=0.30;zr=0.30
zw=0.40;zr=0.40</code></pre>
<p>Example 2:</p>
<pre><code>close all;

rng(123);
ar_z_r_borr_mesh_wage = rand([1,5]);
ar_z_wage_mesh_r_borr = rand([1,5]);
ar_it_rows = round(rand([1,5])*10);
cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr_mesh_wage&#39;, &#39;zr=%3.2f;&#39;), ...
                               num2str(ar_z_wage_mesh_r_borr&#39;, &#39;zw=%3.2f&#39;)]);
cl_col_names = strcat(&#39;zi=&#39;, num2str(ar_it_rows([1,3,5])&#39;), &#39;:&#39;, cl_st_full_rowscols([1,3,5]));
disp(ar_z_r_borr_mesh_wage);

    0.6965    0.2861    0.2269    0.5513    0.7195

disp(ar_z_wage_mesh_r_borr);

    0.4231    0.9808    0.6848    0.4809    0.3921

disp(cl_st_full_rowscols);

    {&#39;zr=0.70;zw=0.42&#39;}
    {&#39;zr=0.29;zw=0.98&#39;}
    {&#39;zr=0.23;zw=0.68&#39;}
    {&#39;zr=0.55;zw=0.48&#39;}
    {&#39;zr=0.72;zw=0.39&#39;}

disp(cl_col_names);

    {&#39;zi=3:zr=0.70;zw=0.42&#39;}
    {&#39;zi=4:zr=0.23;zw=0.68&#39;}
    {&#39;zi=4:zr=0.72;zw=0.39&#39;}</code></pre>
</div>
<div id="combine-number-with-string-cell-array" class="section level4" number="1.4.3.6">
<h4><span class="header-section-number">1.4.3.6</span> Combine Number with String Cell Array</h4>
<p>We have a string cell array we created from the previous section, now
append numbers to it</p>
<pre><code>% Append Common Numbers
cl_col_names_append = strcat(cl_col_names, &#39;-String-Cell-With-Numeric-&#39;, num2str(123));
disp(cl_col_names_append);

    {&#39;zi=3:zr=0.70;zw=0.42-String-Cell-With-Numeric-123&#39;}
    {&#39;zi=4:zr=0.23;zw=0.68-String-Cell-With-Numeric-123&#39;}
    {&#39;zi=4:zr=0.72;zw=0.39-String-Cell-With-Numeric-123&#39;}</code></pre>
</div>
<div id="combine-numeric-array-with-string-cell-array" class="section level4" number="1.4.3.7">
<h4><span class="header-section-number">1.4.3.7</span> Combine Numeric Array with String Cell Array</h4>
<p>Append an array of numeric values</p>
<pre><code>% Append Common Numbers
cl_col_names_append = strcat(cl_col_names, &#39;-String-Cell-With-Numeric-Array-&#39;, ...
    num2str(transpose(1:length(cl_col_names))));
disp(cl_col_names_append);

    {&#39;zi=3:zr=0.70;zw=0.42-String-Cell-With-Numeric-Array-1&#39;}
    {&#39;zi=4:zr=0.23;zw=0.68-String-Cell-With-Numeric-Array-2&#39;}
    {&#39;zi=4:zr=0.72;zw=0.39-String-Cell-With-Numeric-Array-3&#39;}</code></pre>
</div>
<div id="convert-numeric-array-to-string-apeend-prefix-to-all-elements." class="section level4" number="1.4.3.8">
<h4><span class="header-section-number">1.4.3.8</span> Convert Numeric Array to String, Apeend Prefix to all elements.</h4>
<pre><code>ar_fl_abc1 = [0.4 0.1 0.25 0.3 0.4];
ar_st_wth_prefix = strcat(&#39;row=&#39;, string(ar_fl_abc1));
disp(ar_st_wth_prefix);

    &quot;row=0.4&quot;    &quot;row=0.1&quot;    &quot;row=0.25&quot;    &quot;row=0.3&quot;    &quot;row=0.4&quot;


% Does Array Exist in Longer Array as Subset
ar_abc1 = [0.4 0.1 0.25 0.3 0.4];
ar_abc2 = [0.4 0.1 0.2 0.3 0.4];
ar_efg = [0.1 0.2 0.3 0.4 0.1 0.2 0.3 0.4 0.1 0.2 0.3 0.4 0.1 0.2 0.3 0.4];
st_abc1 = strjoin(string(num2str(ar_abc1)));
st_abc2 = strjoin(string(num2str(ar_abc2)));
st_efg = strjoin(string(num2str(ar_efg)));
contains(st_efg, st_abc1)

ans = 
   0

contains(st_efg, st_abc2)

ans = 
   1


% Display Convert to String
fprintf(&#39;Display string [%s]&#39;, num2str([1,2,3]));

Display string [1  2  3]

fprintf(&#39;Display string [%s]&#39;, num2str(1.1));

Display string [1.1]

fprintf(&#39;Display string [%s]&#39;, &#39;abc&#39;);

Display string [abc]</code></pre>

</div>
</div>
</div>
<div id="map-containers" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Map Containers</h2>

<div id="container-map-basics" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Container Map Basics</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="generate-a-container-map-with-any-type-of-data" class="section level4" number="1.5.1.1">
<h4><span class="header-section-number">1.5.1.1</span> Generate a Container map with any Type of data</h4>
<p>Create a container map with float, int, string, and matrix</p>
<pre><code>close all;
clear all;

% Create A Map with String Keys and any values
param_map = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map(&#39;share_unbanked_j&#39;) = 12;
param_map(&#39;equi_r_j&#39;) = 2;
param_map(&#39;equi_w_j&#39;) = &#39;abc&#39;;
param_map(&#39;equi_P_j&#39;) = zeros(2,3);
disp(param_map.keys);

    {&#39;equi_P_j&#39;}    {&#39;equi_r_j&#39;}    {&#39;equi_w_j&#39;}    {&#39;share_unbanked_j&#39;}

disp(param_map.values);

    {2x3 double}    {[2]}    {&#39;abc&#39;}    {[12]}</code></pre>
</div>
<div id="access-multiple-values-of-a-container-map" class="section level4" number="1.5.1.2">
<h4><span class="header-section-number">1.5.1.2</span> Access Multiple Values of a container map</h4>
<p>Values been accessed need to be of the same type</p>
<pre><code>% Parameter Dealing from Map
params_group = values(param_map, {&#39;share_unbanked_j&#39;, &#39;equi_r_j&#39;});
[equi_P_j, equi_r_j] = params_group{:};
disp([&#39;equi_P_j:&#39; num2str(equi_P_j) &#39;, equi_r_j:&#39; num2str(equi_r_j)]);

equi_P_j:12, equi_r_j:2

% Access Scalar Elements of Map and Convert the Array
disp(cell2mat(values(param_map, {&#39;share_unbanked_j&#39;, &#39;equi_r_j&#39;})));

    12     2</code></pre>
<p>Create a container map of color values and generate a array of color
choices:</p>
<pre><code>% Container map with three colors
mp_colors = containers.Map(&#39;KeyType&#39;, &#39;char&#39;, &#39;ValueType&#39;, &#39;any&#39;);
mp_colors(&#39;blue&#39;)   = [57 106 177]./255;
mp_colors(&#39;red&#39;)    = [204 37 41]./255;
mp_colors(&#39;black&#39;)  = [83 81 84]./255;
% An selection array
ar_st_colors_pick = {&#39;blue&#39;, &#39;blue&#39;, &#39;red&#39;, &#39;black&#39;, &#39;blue&#39;};
ar_colors = values(mp_colors, ar_st_colors_pick);
% Print selected colors
celldisp(ar_colors);


ar_colors{1} =
 
    0.2235    0.4157    0.6941



ar_colors{2} =
 
    0.2235    0.4157    0.6941



ar_colors{3} =
 
    0.8000    0.1451    0.1608



ar_colors{4} =
 
    0.3255    0.3176    0.3294



ar_colors{5} =
 
    0.2235    0.4157    0.6941</code></pre>
</div>
<div id="container-integer-keys" class="section level4" number="1.5.1.3">
<h4><span class="header-section-number">1.5.1.3</span> Container Integer Keys</h4>
<p>Given some matrix, I want to store matrix column names as well as labels
for what each row and column correspond to. Achieve this using a cell
array of container maps. Cell dimensions correspond to the first,
second, etc dimensions, any dimension specific information can be stored
in this fashion.</p>
<p>Can access information asssociated with the label value of the row
values:</p>
<pre><code>% Define Matrix Row and Column and additional dimension information
cl_mp_datasetdesc = {};
cl_mp_datasetdesc{1} = containers.Map({&#39;dim&#39;, &#39;name&#39;, &#39;labval&#39;}, {1, &#39;kids&#39;, [0,1,2,3]});
cl_mp_datasetdesc{2} = containers.Map({&#39;dim&#39;, &#39;name&#39;, &#39;labval&#39;}, {2, &#39;age&#39;, [18,19,20]});
% get variable labels for the first dimension (rows)
disp([...
    string([&#39;dim 1 var name:&#39; cl_mp_datasetdesc{1}(&#39;name&#39;) ]), ...
    string([&#39;dim 2 var name:&#39; cl_mp_datasetdesc{2}(&#39;name&#39;) ])...
    ]);

    &quot;dim 1 var name:kids&quot;    &quot;dim 2 var name:age&quot;</code></pre>
</div>
<div id="is-key-in-container" class="section level4" number="1.5.1.4">
<h4><span class="header-section-number">1.5.1.4</span> Is Key In Container</h4>
<pre><code>param_map_a = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map_a(&#39;fl_b_bd&#39;) = -3;
param_map_a(&#39;fl_w_max&#39;) = 50;
param_map_a(&#39;fl_kp_min&#39;) = 0;
param_map_a(&#39;it_w_i&#39;) = 100;

disp([...
    string([&#39;has it_w_i as key? &#39; num2str(isKey(param_map_a, &#39;it_w_i&#39;))]), ...
    string([&#39;has it_w_i1 as key? &#39; num2str(isKey(param_map_a, &#39;it_w_i1&#39;))]) ...
    ]);

    &quot;has it_w_i as key? 1&quot;    &quot;has it_w_i1 as key? 0&quot;</code></pre>
</div>
<div id="container-key-loop" class="section level4" number="1.5.1.5">
<h4><span class="header-section-number">1.5.1.5</span> Container Key Loop</h4>
<p>Generate new container key within loop dynamically</p>
<pre><code>param_map_a = containers.Map(&#39;KeyType&#39;, &#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
rng(&#39;default&#39;);
rng(123);
for st_cur = [&quot;abc&quot;, &quot;efg&quot;, &quot;qqq&quot;]

    if (strcmp(st_cur, &quot;abc&quot;))
       data = rand([1,1]);
    elseif (strcmp(st_cur, &quot;efg&quot;))
       data = 123.123;
    elseif (strcmp(st_cur, &quot;qqq&quot;))
       data = -123;
    end

    % common function
    fl_sh_0p1pc_j = data*2 + 1;
    fl_sh_5pc_j = data/2 - 1;

    % generate map keys
    st_key_sh_0p1pc_j = strjoin([st_cur, &#39;sh_0p1pc_j&#39;], &quot;_&quot;);
    st_key_sh_5pc_j = strjoin([st_cur, &#39;sh_5pc_j&#39;], &quot;_&quot;);

    % store
    param_map_a(st_key_sh_0p1pc_j) = fl_sh_0p1pc_j;
    param_map_a(st_key_sh_5pc_j) = fl_sh_5pc_j;

end

disp([...
    string([&#39;param_map_a.keys:&#39; param_map_a.keys]), ...
    string([&#39;param_map_a.values:&#39; string(param_map_a.values)]) ...
    ]);

  Columns 1 through 7

    &quot;param_map_a.keys:&quot;    &quot;abc_sh_0p1pc_j&quot;    &quot;abc_sh_5pc_j&quot;    &quot;efg_sh_0p1pc_j&quot;    &quot;efg_sh_5pc_j&quot;    &quot;qqq_sh_0p1pc_j&quot;    &quot;qqq_sh_5pc_j&quot;

  Columns 8 through 14

    &quot;param_map_a.values:&quot;    &quot;2.3929&quot;    &quot;-0.65177&quot;    &quot;247.246&quot;    &quot;60.5615&quot;    &quot;-245&quot;    &quot;-62.5&quot;</code></pre>

</div>
</div>
<div id="container-map-display-swtich-key-and-values-and-subseting" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Container Map Display Swtich Key and Values and Subseting</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="print-keys-and-values" class="section level4" number="1.5.2.1">
<h4><span class="header-section-number">1.5.2.1</span> Print Keys and Values</h4>
<p>Define container:</p>
<pre><code>% Define Container
param_map = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map(&#39;share_unbanked_j&#39;) = 12;
param_map(&#39;equi_r_j&#39;) = 2;
param_map(&#39;equi_w_j&#39;) = &#39;abc&#39;;
param_map(&#39;equi_P_j&#39;) = 1.2;</code></pre>
<p>Print the key and values of the container:</p>
<pre><code>param_map_keys = keys(param_map);
param_map_vals = values(param_map);
for i = 1:length(param_map)
    st_key = param_map_keys{i};
    ob_val = param_map_vals{i};
    st_display = strjoin([&#39;pos =&#39; num2str(i) &#39;; key =&#39; string(st_key) &#39;; val =&#39; string(ob_val)]);
    disp(st_display);
end

pos = 1 ; key = equi_P_j ; val = 1.2
pos = 2 ; key = equi_r_j ; val = 2
pos = 3 ; key = equi_w_j ; val = abc
pos = 4 ; key = share_unbanked_j ; val = 12</code></pre>
</div>
<div id="given-map-switch-keys-and-values" class="section level4" number="1.5.2.2">
<h4><span class="header-section-number">1.5.2.2</span> Given Map Switch Keys and Values</h4>
<p>Given the container map below, switch so that keys become values and
values become keys.</p>
<p>First, this is the map that uses strings as keys and index as values:</p>
<pre><code>mp_param_idx = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_param_idx(&#39;parm_sk_mean&#39;) = 1;
mp_param_idx(&#39;parm_sk_sd&#39;) = 2;
mp_param_idx(&#39;NPquad&#39;) = 3;
mp_param_idx(&#39;gamma&#39;) = 4;
mp_param_idx(&#39;HAquad&#39;) = 5;
mp_param_idx(&#39;theta&#39;) = 6;</code></pre>
<p>Second, get the keys and the values, convert the values to string:</p>
<pre><code>param_map_paramNames = keys(mp_param_idx);
param_map_paramIndex_int = values(mp_param_idx);
% convert cell of int to cell of string
param_map_paramIndex_str = cellfun(@(idx) num2str(idx(:)), param_map_paramIndex, &#39;uni&#39;, 0);</code></pre>
<p>Third, generate new Map:</p>
<pre><code>mp_idx_params = containers.Map(param_map_paramIndex_str, param_map_paramNames);
param_map_keys = keys(mp_idx_params);
param_map_vals = values(mp_idx_params);
for i = 1:length(mp_idx_params)
    st_key = param_map_keys{i};
    ob_val = param_map_vals{i};
    st_display = strjoin([&#39;pos =&#39; num2str(i) &#39;; key =&#39; string(st_key) &#39;; val =&#39; string(ob_val)]);
    disp(st_display);
end

pos = 1 ; key = 1 ; val = parm_sk_mean
pos = 2 ; key = 2 ; val = parm_sk_sd
pos = 3 ; key = 3 ; val = NPquad
pos = 4 ; key = 4 ; val = gamma
pos = 5 ; key = 5 ; val = HAquad
pos = 6 ; key = 6 ; val = theta</code></pre>
<p>Overall, code together shorter:</p>
<pre><code>% Single call to convert
mp_idx_params_oneline = containers.Map(...
    cellfun(@(idx) num2str(idx(:)), values(mp_param_idx), &#39;uni&#39;, 0), ...
    keys(mp_param_idx));
% Check equality
disp([&#39;mp_idx_params_oneline==mp_idx_params:&#39; num2str(mp_idx_params_oneline==mp_idx_params) ])

mp_idx_params_oneline==mp_idx_params:0</code></pre>
</div>
<div id="select-of-subset-of-keyvalues-from-a-container-map" class="section level4" number="1.5.2.3">
<h4><span class="header-section-number">1.5.2.3</span> Select of Subset of Key/Values from a Container Map</h4>
<p>There is a larger container map, I want to create a new container map,
that keeps a subset of the keys/values of the full container map.</p>
<pre><code>% Original Container map
param_map = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map(&#39;equi_r_j&#39;) = 0.05;
param_map(&#39;equi_w_j&#39;) = 1.05;
param_map(&#39;equi_P_j&#39;) = 1;
% To select a subset of keys
ls_st_keys_select = {&#39;equi_w_j&#39;, &#39;equi_P_j&#39;};
% Select
param_map_subset = containers.Map(ls_st_keys_select, values(param_map, ls_st_keys_select));
% display
disp(param_map_subset.keys);

    {&#39;equi_P_j&#39;}    {&#39;equi_w_j&#39;}

disp(param_map_subset.values);

    {[1]}    {[1.0500]}</code></pre>

</div>
</div>
<div id="container-map-example-overriding" class="section level3" number="1.5.3">
<h3><span class="header-section-number">1.5.3</span> Container Map Example Overriding</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="update-container-map" class="section level4" number="1.5.3.1">
<h4><span class="header-section-number">1.5.3.1</span> Update Container Map</h4>
<p>There is one map with values, Container Map A. There is another
container Map, Container Map B. Container Maps A and B share keys. For
keys that exist in B and A, B Key value supercede values for the same
keys in A. For new keys in B, they superced keys in A.</p>
<pre><code>param_map_a = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map_a(&#39;fl_b_bd&#39;) = -3;
param_map_a(&#39;fl_w_max&#39;) = 50;
param_map_a(&#39;fl_kp_min&#39;) = 0;
param_map_a(&#39;it_w_i&#39;) = 100;

param_map_b = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
param_map_b(&#39;fl_w_max&#39;) = 77;
param_map_b(&#39;fl_kp_min&#39;) = -231;
param_map_b(&#39;it_z_n&#39;) = 5;
param_map_b(&#39;fl_z_mu&#39;) = 0;

param_map_c = [param_map_a; param_map_b];
param_map_c.keys

ans = 
    {&#39;fl_b_bd&#39;}    {&#39;fl_kp_min&#39;}    {&#39;fl_w_max&#39;}    {&#39;fl_z_mu&#39;}    {&#39;it_w_i&#39;}    {&#39;it_z_n&#39;}

param_map_c.values

ans = 
    {[-3]}    {[-231]}    {[77]}    {[0]}    {[100]}    {[5]}</code></pre>

</div>
</div>
</div>
<div id="map-structure-array" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Map Structure Array</h2>

<div id="maplab-nested-container-map-with-struct" class="section level3" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Maplab Nested Container Map with Struct</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Package, <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="a-struct-of-model-parameters-with-different-information" class="section level4" number="1.6.1.1">
<h4><span class="header-section-number">1.6.1.1</span> A Struct of Model Parameters with Different Information</h4>
<p>There is a list of model parameters, there are various information we
store for each parameter. Store each type of information in a different
container map, and then combine them together in a struct. This is more
flexible than generating a table, and can be called with a single line.
This is effectively a nested container, imagine if we define for each
parameter a map with keys indicating different types of information.
Rather than doing that, the keys are elements of the struct, each
key/value is in a different container.</p>
<pre><code>% index for different parameters
mp_param_idx = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_param_idx(&#39;NPquad&#39;) = 3;
mp_param_idx(&#39;gamma&#39;) = 4;
mp_param_idx(&#39;HAquad&#39;) = 5;
mp_param_idx(&#39;theta&#39;) = 6;
mp_param_idx(&#39;lambda&#39;) = 7;
mp_param_idx(&#39;msrErrProtSD&#39;) = 8;
mp_param_idx(&#39;logProt&#39;) = 9;
mp_param_idx(&#39;freePriceFrac&#39;) = 10;
mp_param_idx(&#39;h_exoshk_sd&#39;) = 11;
mp_param_idx(&#39;h_endoshk_sd&#39;) = 12;

% Invert key and index
mp_idx_params = containers.Map(...
    cellfun(@(idx) num2str(idx(:)), values(mp_param_idx), &#39;uni&#39;, 0), ...
    keys(mp_param_idx));

% Exponentiation Positivity Restrictions
mp_param_explog = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_param_explog(&#39;NPquad&#39;) = -1;
mp_param_explog(&#39;gamma&#39;) = 1;
mp_param_explog(&#39;lambda&#39;) = -1;
mp_param_explog(&#39;msrErrProtSD&#39;) = 1;
mp_param_explog(&#39;freePriceFrac&#39;) = 1;
mp_param_explog(&#39;h_exoshk_sd&#39;) = 1;
mp_param_explog(&#39;h_endoshk_sd&#39;) = 1;

% Create Struct
param_struct.paramindex = mp_param_idx;
param_struct.paramstring = mp_idx_params;
param_struct.explog = mp_param_explog;</code></pre>
<p>Given the struct contructed, can get the index for a particular
parameter, or the explog value in a single line call:</p>
<pre><code>% Get values in single line
disp([&#39;NPquad index=&#39; num2str(param_struct.index(&#39;NPquad&#39;)) ...
    &#39;, explog=&#39; num2str(param_struct.explog(&#39;NPquad&#39;))]);

NPquad index=3, explog=-1</code></pre>
<p>Furthermore, since we have both mp_param_idx and mp_idx_params, suppose
we only know the current index, we can use to index to find the string,
and use the string to find the expolog value:</p>
<pre><code>% Get the explog value for a particular index
st_param = param_struct.paramstring(&#39;11&#39;);
it_explog = param_struct.explog(st_param);
% Single line call
disp([&#39;The explog of parameter index 11 is &quot;&#39; ...
    num2str(param_struct.explog(param_struct.paramstring(&#39;11&#39;))) ...
    &#39;&quot; (param index 11 is &quot;&#39; st_param &#39;&quot;)&#39;]);

The explog of parameter index 11 is &quot;1&quot; (param index 11 is &quot;h_exoshk_sd&quot;)</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions-and-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Data-Structures-and-Dynamic-Optimization-with-Matlab.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
