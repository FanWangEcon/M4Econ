<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2020b"><title>Nonlinear Estimation with Fminunc</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Nonlinear Estimation with Fminunc</span></h1><div  class = 'S1'><span style=' font-weight: bold;'>back to </span><a href = "https://fanwangecon.github.io"><span style=' font-weight: bold;'>Fan</span></a><span style=' font-weight: bold;'>'s </span><a href = "https://fanwangecon.github.io/Math4Econ/"><span style=' font-weight: bold;'>Intro Math for Econ</span></a><span style=' font-weight: bold;'>,  </span><a href = "https://fanwangecon.github.io/M4Econ/"><span style=' font-weight: bold;'>Matlab Examples</span></a><span style=' font-weight: bold;'>, or </span><a href = "https://fanwangecon.github.io/MEconTools/"><span style=' font-weight: bold;'>MEconTools</span></a><span style=' font-weight: bold;'> Repositories</span></div><h2  class = 'S2'><span>Nonlinear Estimation Inputs LHS and RHS</span></h2><div  class = 'S1'><span>Estimate this equation: </span><span texencoding="\omega_t =\left(\nu_0 + a_0\right) + a_1 t - \log\left(1 - \exp\left( a_0 + a_1 t\right)\right) + \nu_t" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="306.5" height="20" /></span><span>. We have data from multiple </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">t</span><span>, and want to estimate the </span><span texencoding="a_0" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAoCAYAAAAG0SEsAAACa0lEQVRYR+3XSciOYRQG4OuPkrAwhCjDQuwoC0JkYSpj2ZgJZWOWqWQqJEMWlGRhHpIhSbFBWRBlyELZIISFWFDK0Knn1evx+/Xx8S987+rr7XnPfe773Od++uo04lPXiNhq4I2ifk32muz/VIGa4f6p3AVYTfaGZA91emEOOuEhOuNsetcDk3Gv0tn9SvY2WI7RWIGL+IzuOIZ+OJWaeFtN8GC3G30wA1dLxdviCEZgCXZWChznf8a8A/ZiHKYloC8lgK44igEYgmvVAm+K9ViNg5iPd1nx/riE+2nej6sFPhjH0RITE0heezF2JHXi94fSgfBJjKILXiZzbsWdvEguezPEwQU4g9l4k33UHvswFvNSA8WRYlzPklHfYxLWYRaul2vl4D1xAr2xNBmpPOv4dgoO4wXG4HYqGLVChWUYj5vpfTscwqt8hDn4sJLMw3E5Y90tAQ/EldTI8wwkPBN7/zq9b4KNmJk19YPbC1bx3aBMphapSKzeUOxJ6kTwxJwDNEwYyi1ESF4803EgX8uGmE9NKxYFWiXgWwjWMesw1UkswrYUOOd+YsKCVOTBSnysb88jWGI+wewudqVEi0a2I8Bj3hEukWwh6aoUuQXAZqzBpxLzMOcPjdUXMpHjGzASj3A67fsTNMemtAUBvhZPE0hD4IWXIri+reavsr2S7KiXXdZYg7JXApaf7YvzuPC7hvsT8GKf81ULdWM8YdBR5Q2qpuxRK5Ixrt5yyLTG/sTqu8SsJnjUL+L1QWIbjp+ALZibXct/5S9yxxQ+0UhcLHH9xiV0A99FdbWZV+SZGnhFclXr8P8r+1euIIspFmTPfwAAAABJRU5ErkJggg==" width="15.5" height="20" /></span><span>, and </span><span texencoding="a_1" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAoCAYAAAAG0SEsAAAB7UlEQVRYR+3WS6hNcRTH8c+NQphQFAOPEiPMCBHlMfBIGXlkwMDAWxGRUAbyyICSorxJmCkmKDMGGCkTFBmJiUzQqnVr293j3n1t5wzsXad2p/9e37V+a63f3l06eHV1kK2Bd0T9RvZG9rYq0AxcW+XuhjWy/0n2UGcKNmIMXmMs7uV/k7AaL6v2rjfZR2A3lmIP7uMHJuA6ZuB2JvGlTnhUdwbTsR6PC8FH4ioWYydOVQXH+VaVj8Y5rMC6BP0sAMbhGmZhHp7UBR+IQ9iHS9iCr6XgM/EAr7Lfb+uCz8UNDMOqhJRj78DJVCfuv5UOhKJTc06idU97Sq4s+yAcw1bcxQZ8Lj04CuexHJsygeKR8diMlZiIOX2FT8ZNTMOuHKRirwOyBlfwEcvwvJTcYHzHfhyuAl9YkHkRHpYCR1UBno1HmciHFv0+UBXeXVXEK8s1FEdy9ebjbKoTxhN+8KyURGV4sfK1uWIRc3iCAxBVR69jv29hO47j09/Cw1guIyp7gdPpaJHIiawuZA9zCWcbgL1puWX1K1ceAcLHY1CW4A3u5L6/wxAczS0I+EG8r6vn/fGKVs/0q/K6EmjgfXa4uiQP245hjF9b4fG6XYBtadMXcDFt+LcXUG9fMnUp0WOcBv5P5W0V/P+V/RdaQmgpp/y/QwAAAABJRU5ErkJggg==" width="15.5" height="20" /></span><span> coefficients mainly, but also </span><span texencoding="\nu_0" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAoCAYAAADpE0oSAAACVklEQVRYR+3WSaiOcRTH8c+NkoSIwoKUTCkLQ7IgyrAwloxRMiYpGTaSEFkYSskQIRGiDAtTEcpCLEhhaYEFJYlSpo7+z+3p8bjue+973c37bN9zzu+c7xn+b51W+upaSVdN+L+Rr6GuoW4xArXhajG0xcA11EGkPXpgMEZgFB5hC74XkLXDMpzDu0r6VIa6D/pjMealYNNxpSRwX6zEVnxprnDmvwgn8QRz8LIk8BJ0wr5KRMP2b8MVuCPYCpzAanwuBA/BvTiCh9USDtxnMDqhPFwSeGLq73J8qJbwBNzEW0zF40LgLohkbuBY7re2mIW5eIYhOIsL+JaPUYa6TZrgzbiOhXifcwqfNZiCmINILr4QXYeZaTCfYxCO42JqS/1WlAl3wylMRojvwM8UPOzH4RA24HIuoZG4hN1pPsIn7DdhfqLwNLMvEx6Gq+iJ6OOtnGgkcxCnE5UMXyawHWNxL5dQ1ragEQP7u4gy4ZjkqOhByvQVuieMqxKNjYUpj54Hpd6YjRc54YE4n9ZxKT6WCXfEgdTXwBbBxqdD0hW7sBOfCsOWbUGHkp0fkC5brGMgj0L+qDgzGloIfB/bcBs/SlYn84u1WoA3OZvSpIqoY0CupYriYt1JKxNXq0wwi9+QcK80E9GO+gtYrWex2agrPUCZfWccRVTepOFqqnBD6zQGd4s3oVqoI+Hh6TTuLxyQtViPGfnHpJrC2cmclNbxNfql1y0O0p78va6mcFQd/0hinablHon4AxGX7uu/Homm9rkiv2pX3GjxmnCjUTXXsNVQ/wKbZ4MpKb/brgAAAABJRU5ErkJggg==" width="15" height="20" /></span><span> is good as well. This is an estimation problem with 3 unknowns. </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">t</span><span> ranges from </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% LHS outcome variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>ar_w = [-1.7349,-1.5559,-1.4334,-1.3080,-1.1791,-1.0462,-0.9085,-0.7652,-0.6150,-0.4564,-0.2874,-0.1052,0.0943];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% RHS t variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>ar_t = [0,3,5,7,9,11,13,15,16,19,21,23,25];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% actual parameters, estimation checks if gets actual parameters back</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>ar_a = [-1.8974, 0.0500];</span></span></div></div></div><h2  class = 'S2'><span>Prediction and MSE Equations</span></h2><div  class = 'S1'><span>Objective function for prediction and mean-squared-error.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>obj_ar_predictions = @(a) (v_0 + a(1) + a(2).*ar_t - log(1 - exp(a(1) + a(2).*ar_t)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>obj_fl_mse = @(a) mean((obj_ar_predictions(a) - ar_w).^2);</span></span></div></div></div><div  class = 'S6'><span>Evaluate given ar_a vectors.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>ar_predict_at_actual = obj_ar_predictions(ar_a);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>fl_mse_at_actual = obj_fl_mse(ar_a);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>mt_compare = [ar_w', ar_predict_at_actual'];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>tb_compare = array2table(mt_compare);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>tb_compare.Properties.VariableNames = {</span><span style="color: rgb(170, 4, 249);">'lhs-outcomes'</span><span>, </span><span style="color: rgb(170, 4, 249);">'evaluate-rhs-at-actual-parameters'</span><span>};</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre;"><span>disp(tb_compare);</span></span></div><div  class = 'S8'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="2EA3E315" data-testid="output_0" data-width="1128" data-height="227" data-hashorizontaloverflow="false" style="width: 1158px; max-height: 261px;"><div class="textElement">    <strong>lhs-outcomes</strong>    <strong>evaluate-rhs-at-actual-parameters</strong>
    <strong>____________</strong>    <strong>_________________________________</strong>

      -1.7349                    -1.7349             
      -1.5559                     -1.556             
      -1.4334                    -1.4335             
       -1.308                    -1.3081             
      -1.1791                    -1.1793             
      -1.0462                    -1.0464             
      -0.9085                   -0.90877             
      -0.7652                   -0.76546             
       -0.615                   -0.69133             
      -0.4564                   -0.45679             
      -0.2874                   -0.28786             
      -0.1052                   -0.10571             
       0.0943                   0.093688             </div></div></div></div></div><h2  class = 'S2'><span>Unconstrained Nonlinear Estimation</span></h2><div  class = 'S1'><span>Estimation to minimize mean-squared-error.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% Estimation options</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>options = optimset(</span><span style="color: rgb(170, 4, 249);">'display'</span><span>,</span><span style="color: rgb(170, 4, 249);">'off'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% Starting values</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>ar_a_init = [-10, -10];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% Optimize</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>[ar_a_opti, fl_fval] = fminunc(obj_est, ar_a_init, options);</span></span></div></div></div><div  class = 'S6'><span>Compare results.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mt_compare = [ar_a_opti', ar_a'];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>tb_compare = array2table(mt_compare);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>tb_compare.Properties.VariableNames = {</span><span style="color: rgb(170, 4, 249);">'estimated-best-fit'</span><span>, </span><span style="color: rgb(170, 4, 249);">'actual-parameters'</span><span>};</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre;"><span>disp(tb_compare);</span></span></div><div  class = 'S8'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="5486BB70" data-testid="output_1" data-width="1128" data-height="73" data-hashorizontaloverflow="false" style="width: 1158px; max-height: 261px;"><div class="textElement">    <strong>estimated-best-fit</strong>    <strong>actual-parameters</strong>
    <strong>__________________</strong>    <strong>_________________</strong>

          -1.8939              -1.8974     
         0.050037                 0.05     </div></div></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Nonlinear Estimation with Fminunc
% *back to* <https://fanwangecon.github.io *Fan*>*'s* <https://fanwangecon.github.io/Math4Econ/ 
% *Intro Math for Econ*>*,*  <https://fanwangecon.github.io/M4Econ/ *Matlab Examples*>*, 
% or* <https://fanwangecon.github.io/MEconTools/ *MEconTools*> *Repositories*
%% Nonlinear Estimation Inputs LHS and RHS
% Estimate this equation: $\omega_t =\left(\nu_0 + a_0\right) + a_1 t - \log\left(1 
% - \exp\left( a_0 + a_1 t\right)\right) + \nu_t$. We have data from multiple 
% $t$, and want to estimate the $a_0$, and $a_1$ coefficients mainly, but also 
% $\nu_0$ is good as well. This is an estimation problem with 3 unknowns. $t$ 
% ranges from 

% LHS outcome variable
ar_w = [-1.7349,-1.5559,-1.4334,-1.3080,-1.1791,-1.0462,-0.9085,-0.7652,-0.6150,-0.4564,-0.2874,-0.1052,0.0943];
% RHS t variable
ar_t = [0,3,5,7,9,11,13,15,16,19,21,23,25];
% actual parameters, estimation checks if gets actual parameters back
ar_a = [-1.8974, 0.0500];
%% Prediction and MSE Equations
% Objective function for prediction and mean-squared-error.

obj_ar_predictions = @(a) (v_0 + a(1) + a(2).*ar_t - log(1 - exp(a(1) + a(2).*ar_t)));
obj_fl_mse = @(a) mean((obj_ar_predictions(a) - ar_w).^2);
%% 
% Evaluate given ar_a vectors.

ar_predict_at_actual = obj_ar_predictions(ar_a);
fl_mse_at_actual = obj_fl_mse(ar_a);
mt_compare = [ar_w', ar_predict_at_actual'];
tb_compare = array2table(mt_compare);
tb_compare.Properties.VariableNames = {'lhs-outcomes', 'evaluate-rhs-at-actual-parameters'};
disp(tb_compare);
%% Unconstrained Nonlinear Estimation
% Estimation to minimize mean-squared-error.

% Estimation options
options = optimset('display','off');
% Starting values
ar_a_init = [-10, -10];
% Optimize
[ar_a_opti, fl_fval] = fminunc(obj_est, ar_a_init, options);
%% 
% Compare results.

mt_compare = [ar_a_opti', ar_a'];
tb_compare = array2table(mt_compare);
tb_compare.Properties.VariableNames = {'estimated-best-fit', 'actual-parameters'};
disp(tb_compare);
##### SOURCE END #####
--></body></html>